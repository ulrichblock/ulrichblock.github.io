{"componentChunkName":"component---src-templates-tag-tsx","path":"/tags/security/","result":{"data":{"site":{"siteMetadata":{"title":"Ulrich Block","author":"Ulrich Block","labels":[{"tag":"react","tech":"React","name":"M12 9.861A2.139 2.139 0 1 0 12 14.139 2.139 2.139 0 1 0 12 9.861zM6.008 16.255l-.472-.12C2.018 15.246 0 13.737 0 11.996s2.018-3.25 5.536-4.139l.472-.119.133.468a23.53 23.53 0 0 0 1.363 3.578l.101.213-.101.213a23.307 23.307 0 0 0-1.363 3.578l-.133.467zM5.317 8.95c-2.674.751-4.315 1.9-4.315 3.046 0 1.145 1.641 2.294 4.315 3.046a24.95 24.95 0 0 1 1.182-3.046A24.752 24.752 0 0 1 5.317 8.95zM17.992 16.255l-.133-.469a23.357 23.357 0 0 0-1.364-3.577l-.101-.213.101-.213a23.42 23.42 0 0 0 1.364-3.578l.133-.468.473.119c3.517.889 5.535 2.398 5.535 4.14s-2.018 3.25-5.535 4.139l-.473.12zm-.491-4.259c.48 1.039.877 2.06 1.182 3.046 2.675-.752 4.315-1.901 4.315-3.046 0-1.146-1.641-2.294-4.315-3.046a24.788 24.788 0 0 1-1.182 3.046zM5.31 8.945l-.133-.467C4.188 4.992 4.488 2.494 6 1.622c1.483-.856 3.864.155 6.359 2.716l.34.349-.34.349a23.552 23.552 0 0 0-2.422 2.967l-.135.193-.235.02a23.657 23.657 0 0 0-3.785.61l-.472.119zm1.896-6.63c-.268 0-.505.058-.705.173-.994.573-1.17 2.565-.485 5.253a25.122 25.122 0 0 1 3.233-.501 24.847 24.847 0 0 1 2.052-2.544c-1.56-1.519-3.037-2.381-4.095-2.381zM16.795 22.677c-.001 0-.001 0 0 0-1.425 0-3.255-1.073-5.154-3.023l-.34-.349.34-.349a23.53 23.53 0 0 0 2.421-2.968l.135-.193.234-.02a23.63 23.63 0 0 0 3.787-.609l.472-.119.134.468c.987 3.484.688 5.983-.824 6.854a2.38 2.38 0 0 1-1.205.308zm-4.096-3.381c1.56 1.519 3.037 2.381 4.095 2.381h.001c.267 0 .505-.058.704-.173.994-.573 1.171-2.566.485-5.254a25.02 25.02 0 0 1-3.234.501 24.674 24.674 0 0 1-2.051 2.545zM18.69 8.945l-.472-.119a23.479 23.479 0 0 0-3.787-.61l-.234-.02-.135-.193a23.414 23.414 0 0 0-2.421-2.967l-.34-.349.34-.349C14.135 1.778 16.515.767 18 1.622c1.512.872 1.812 3.37.824 6.855l-.134.468zM14.75 7.24c1.142.104 2.227.273 3.234.501.686-2.688.509-4.68-.485-5.253-.988-.571-2.845.304-4.8 2.208A24.849 24.849 0 0 1 14.75 7.24zM7.206 22.677A2.38 2.38 0 0 1 6 22.369c-1.512-.871-1.812-3.369-.823-6.854l.132-.468.472.119c1.155.291 2.429.496 3.785.609l.235.02.134.193a23.596 23.596 0 0 0 2.422 2.968l.34.349-.34.349c-1.898 1.95-3.728 3.023-5.151 3.023zm-1.19-6.427c-.686 2.688-.509 4.681.485 5.254.987.563 2.843-.305 4.8-2.208a24.998 24.998 0 0 1-2.052-2.545 24.976 24.976 0 0 1-3.233-.501zM12 16.878c-.823 0-1.669-.036-2.516-.106l-.235-.02-.135-.193a30.388 30.388 0 0 1-1.35-2.122 30.354 30.354 0 0 1-1.166-2.228l-.1-.213.1-.213a30.3 30.3 0 0 1 1.166-2.228c.414-.716.869-1.43 1.35-2.122l.135-.193.235-.02a29.785 29.785 0 0 1 5.033 0l.234.02.134.193a30.006 30.006 0 0 1 2.517 4.35l.101.213-.101.213a29.6 29.6 0 0 1-2.517 4.35l-.134.193-.234.02c-.847.07-1.694.106-2.517.106zm-2.197-1.084c1.48.111 2.914.111 4.395 0a29.006 29.006 0 0 0 2.196-3.798 28.585 28.585 0 0 0-2.197-3.798 29.031 29.031 0 0 0-4.394 0 28.477 28.477 0 0 0-2.197 3.798 29.114 29.114 0 0 0 2.197 3.798z","size":20,"color":"deepskyblue","viewBox":null},{"tag":"nodejs","tech":"Node.js","name":"M11.177 25.3a1.94 1.94 0 0 1-.969-.259l-3.086-1.826c-.46-.257-.235-.349-.083-.402.614-.213.739-.262 1.394-.635.069-.038.159-.024.231.018l2.37 1.407a.304.304 0 0 0 .287 0l9.241-5.333a.292.292 0 0 0 .141-.25V7.355a.3.3 0 0 0-.143-.255l-9.237-5.329a.29.29 0 0 0-.285 0L1.803 7.102a.296.296 0 0 0-.146.253v10.666c0 .102.056.198.145.247l2.532 1.462c1.374.687 2.215-.122 2.215-.935V8.265c0-.149.12-.266.269-.266H7.99c.146 0 .267.117.267.266v10.53c0 1.833-.998 2.885-2.736 2.885-.534 0-.955 0-2.129-.579L.969 19.706A1.953 1.953 0 0 1 0 18.02V7.355c0-.693.371-1.339.969-1.684l9.242-5.34a2.023 2.023 0 0 1 1.942 0l9.241 5.34c.599.346.971.992.971 1.684V18.02c0 .693-.372 1.337-.971 1.686l-9.241 5.335a1.942 1.942 0 0 1-.973.259zm2.855-7.348c-4.045 0-4.892-1.857-4.892-3.414 0-.148.118-.266.266-.266h1.195c.133 0 .245.096.265.226.18 1.216.717 1.831 3.164 1.831 1.946 0 2.775-.441 2.775-1.473 0-.596-.234-1.037-3.26-1.334-2.528-.25-4.093-.809-4.093-2.831 0-1.865 1.572-2.977 4.207-2.977 2.961 0 4.425 1.027 4.611 3.233a.27.27 0 0 1-.267.291h-1.2a.266.266 0 0 1-.259-.209c-.288-1.28-.988-1.689-2.886-1.689-2.126 0-2.373.74-2.373 1.295 0 .673.292.869 3.161 1.248 2.84.375 4.19.907 4.19 2.902 0 2.014-1.678 3.167-4.606 3.167z","size":20,"color":"lightgreen","viewBox":"0 0 24 24"},{"tag":"git","tech":"Git","name":"M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.215 1.379-.07 1.889.441.516.515.658 1.258.438 1.9l2.658 2.66c.645-.223 1.387-.078 1.9.435.721.72.721 1.884 0 2.604-.719.719-1.881.719-2.6 0-.539-.541-.674-1.337-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348.713.721.713 1.883 0 2.6-.719.721-1.889.721-2.609 0-.719-.719-.719-1.879 0-2.598.182-.18.387-.316.605-.406V8.835c-.217-.091-.424-.222-.6-.401-.545-.545-.676-1.342-.396-2.009L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477c.604.604 1.582.604 2.186 0l10.43-10.43c.605-.603.605-1.582 0-2.187","size":20,"color":"white","viewBox":"0 0 24 24"},{"tag":"github","tech":"GitHub","name":"M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z","size":20,"color":"white","viewBox":"0 0 16 15"},{"tag":"javascript","tech":"JavaScript","name":"M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z","size":20,"color":"yellow","viewBox":"0 0 24 24"},{"tag":"typescript","tech":"TypeScript","name":"M87.7 200.7V217h52v148h36.9V217h52v-16c0-9 0-16.3-.4-16.5 0-.3-31.7-.4-70.2-.4l-70 .3v16.4l-.3-.1zM321.4 184c10.2 2.4 18 7 25 14.3 3.7 4 9.2 11 9.6 12.8 0 .6-17.3 12.3-27.8 18.8-.4.3-2-1.4-3.6-4-5.2-7.4-10.5-10.6-18.8-11.2-12-.8-20 5.5-20 16 0 3.2.6 5 1.8 7.6 2.7 5.5 7.7 8.8 23.2 15.6 28.6 12.3 41 20.4 48.5 32 8.5 13 10.4 33.4 4.7 48.7-6.4 16.7-22 28-44.3 31.7-7 1.2-23 1-30.5-.3-16-3-31.3-11-40.7-21.3-3.7-4-10.8-14.7-10.4-15.4l3.8-2.4 15-8.7 11.3-6.6 2.6 3.5c3.3 5.2 10.7 12.2 15 14.6 13 6.7 30.4 5.8 39-2 3.7-3.4 5.3-7 5.3-12 0-4.6-.7-6.7-3-10.2-3.2-4.4-9.6-8-27.6-16-20.7-8.8-29.5-14.4-37.7-23-4.7-5.2-9-13.3-11-20-1.5-5.8-2-20-.6-25.7 4.3-20 19.4-34 41-38 7-1.4 23.5-.8 30.4 1l-.2.2z","size":20,"color":"white","viewBox":"0 50 400 300"},{"tag":"css","tech":"CSS","name":"M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.523-2.91.804-2.956-.81-.188-2.11h-2.61l.29 3.855L12 19.288l5.373-1.53L18.59 4.414z","size":20,"color":"teal","viewBox":"0 0 24 24"},{"tag":"python","tech":"Python","name":"M14.31.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.83l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.23l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05L0 11.97l.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.24l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05 1.07.13zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09-.33.22zM21.1 6.11l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01.21.03zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08-.33.23z","size":20,"color":"deepskyblue","viewBox":null},{"tag":"ruby","tech":"Ruby","name":"M20.156.083c3.033.525 3.893 2.598 3.829 4.77L24 4.822 22.635 22.71 4.89 23.926h.016C3.433 23.864.15 23.729 0 19.139l1.645-3 2.819 6.586.503 1.172 2.805-9.144-.03.007.016-.03 9.255 2.956-1.396-5.431-.99-3.9 8.82-.569-.615-.51L16.5 2.114 20.159.073l-.003.01zM0 19.089v.026-.029.003zM5.13 5.073c3.561-3.533 8.157-5.621 9.922-3.84 1.762 1.777-.105 6.105-3.673 9.636-3.563 3.532-8.103 5.734-9.864 3.957-1.766-1.777.045-6.217 3.612-9.75l.003-.003z","size":20,"color":"crimson","viewBox":null},{"tag":"java","tech":"Java","name":"M8.851 18.56s-.917.534.653.714c1.902.218 2.874.187 4.969-.211 0 0 .552.346 1.321.646-4.699 2.013-10.633-.118-6.943-1.149M8.276 15.933s-1.028.761.542.924c2.032.209 3.636.227 6.413-.308 0 0 .384.389.987.602-5.679 1.661-12.007.13-7.942-1.218M13.116 11.475c1.158 1.333-.304 2.533-.304 2.533s2.939-1.518 1.589-3.418c-1.261-1.772-2.228-2.652 3.007-5.688 0-.001-8.216 2.051-4.292 6.573M19.33 20.504s.679.559-.747.991c-2.712.822-11.288 1.069-13.669.033-.856-.373.75-.89 1.254-.998.527-.114.828-.093.828-.093-.953-.671-6.156 1.317-2.643 1.887 9.58 1.553 17.462-.7 14.977-1.82M9.292 13.21s-4.362 1.036-1.544 1.412c1.189.159 3.561.123 5.77-.062 1.806-.152 3.618-.477 3.618-.477s-.637.272-1.098.587c-4.429 1.165-12.986.623-10.522-.568 2.082-1.006 3.776-.892 3.776-.892M17.116 17.584c4.503-2.34 2.421-4.589.968-4.285-.355.074-.515.138-.515.138s.132-.207.385-.297c2.875-1.011 5.086 2.981-.928 4.562 0-.001.07-.062.09-.118M14.401 0s2.494 2.494-2.365 6.33c-3.896 3.077-.888 4.832-.001 6.836-2.274-2.053-3.943-3.858-2.824-5.539 1.644-2.469 6.197-3.665 5.19-7.627M9.734 23.924c4.322.277 10.959-.153 11.116-2.198 0 0-.302.775-3.572 1.391-3.688.694-8.239.613-10.937.168 0-.001.553.457 3.393.639","size":20,"color":"wheat","viewBox":null},{"tag":"angular","tech":"Angular","name":"M9.93 12.645h4.134L11.996 7.74M11.996.009L.686 3.988l1.725 14.76 9.585 5.243 9.588-5.238L23.308 3.99 11.996.01zm7.058 18.297h-2.636l-1.42-3.501H8.995l-1.42 3.501H4.937l7.06-15.648 7.057 15.648z","size":20,"color":"red","viewBox":null},{"tag":"html","tech":"HTML","name":"M1.5 0h21l-1.91 21.563L11.977 24l-8.564-2.438L1.5 0zm7.031 9.75l-.232-2.718 10.059.003.23-2.622L5.412 4.41l.698 8.01h9.126l-.326 3.426-2.91.804-2.955-.81-.188-2.11H6.248l.33 4.171L12 19.351l5.379-1.443.744-8.157H8.531z","size":20,"color":"darkorange","viewBox":"0 0 24 24"},{"tag":"php","tech":"PHP","name":"M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z","size":20,"color":"violet","viewBox":"0 0 24 24"},{"tag":"mongodb","tech":"MongoDB","name":"M17.18 9.518c-1.263-5.56-4.242-7.387-4.562-8.086C12.266.939 11.885 0 11.885 0c-.002.019-.004.031-.005.049v.013h-.001c-.002.015-.003.025-.004.039v.015h-.002c0 .01-.002.018-.002.026v.026h-.003c-.001.008-.001.018-.003.025v.021h-.002c0 .007 0 .015-.002.021v.02h-.002c0 .01-.001.022-.002.032v.002c-.003.017-.006.034-.009.05v.008h-.002c-.001.004-.003.008-.003.012v.017h-.003v.022h-.005v.018h-.005v.021h-.004v.019h-.004v.017h-.006v.014h-.004v.018h-.004v.014h-.005v.013H11.8v.015h-.004c-.001.001-.001.003-.001.004v.01h-.003c-.001.002-.001.004-.001.006v.006h-.002c-.001.003-.002.008-.002.01-.003.007-.007.014-.01.021v.002c-.002.002-.004.005-.005.007v.008h-.004v.008h-.005v.008h-.003v.01h-.006v.014h-.004v.004h-.004v.008h-.004v.011h-.004v.008h-.006v.011h-.004v.008h-.005v.008h-.003v.01h-.005v.008h-.004v.006h-.004v.008h-.006V.76h-.004v.006h-.005v.008h-.004v.011h-.005v.004h-.003v.008h-.006v.004h-.004v.01h-.004v.004h-.004v.008h-.005v.006h-.003l-.002.004v.004h-.002c-.001.002-.002.002-.002.004v.001h-.001c-.001.003-.002.005-.004.007v.003h-.001c-.005.006-.008.012-.012.018v.001c-.002.002-.007.006-.009.01v.002h-.001c-.001.001-.003.002-.003.003v.003h-.002l-.003.003v.001h-.001c0 .001-.002.002-.003.004v.004h-.003l-.002.002v.002h-.002c0 .002-.002.002-.002.003v.003h-.004c0 .001-.001.002-.002.003V.92h-.003v.004h-.004V.93h-.004v.008h-.005V.93h-.005v.004h-.004V.94h-.005v.008h-.005v.004h-.004v.006h-.004v.004h-.004V.97h-.006v.004h-.004V.98h-.005v.004h-.004v.005h-.005v.01h-.002v.004h-.006v.005h-.004v.002h-.004v.004h-.005v.01h-.004v.004h-.005v.004h-.004v.006h-.005v.004h-.005v.004h-.004v.004h-.004v.01h-.004v.005h-.006v.004h-.004v.004h-.005v.006h-.004v.004h-.005v.007h-.004v.004h-.006V1.1h-.002v.004h-.004v.004h-.005v.004h-.004v.006h-.005v.004h-.003c-.001.001-.001.002-.001.002v.002h-.002l-.004.004s-.002.002-.004.003v.006h-.004v.005h-.004v.004h-.004v.004h-.003l-.003.003v.003h-.002l-.002.002v.003h-.002c-.005.006-.007.01-.014.016-.002.002-.008.007-.012.01-.012.008-.027.021-.039.032-.008.005-.016.012-.022.017v.001h-.001c-.016.013-.031.025-.049.039v.001c-.024.02-.047.039-.074.062V1.34h-.002c-.057.047-.117.1-.186.159V1.5h-.001c-.169.148-.37.338-.595.568l-.015.015-.004.004C9 3.494 6.857 6.426 6.631 11.164c-.02.392-.016.773.006 1.144v.009c.109 1.867.695 3.461 1.428 4.756v.001c.292.516.607.985.926 1.405v.001c1.102 1.455 2.227 2.317 2.514 2.526.441 1.023.4 2.779.4 2.779l.644.215s-.131-1.701.053-2.522c.057-.257.192-.476.349-.662.106-.075.42-.301.797-.645.018-.019.028-.036.044-.054 1.521-1.418 4.362-4.91 3.388-10.599z","size":20,"color":"green","viewBox":null},{"tag":"vscode","tech":"VS Code","name":"M23.15 2.587L18.21.21a1.494 1.494 0 0 0-1.705.29l-9.46 8.63-4.12-3.128a.999.999 0 0 0-1.276.057L.327 7.261A1 1 0 0 0 .326 8.74L3.899 12 .326 15.26a1 1 0 0 0 .001 1.479L1.65 17.94a.999.999 0 0 0 1.276.057l4.12-3.128 9.46 8.63a1.492 1.492 0 0 0 1.704.29l4.942-2.377A1.5 1.5 0 0 0 24 20.06V3.939a1.5 1.5 0 0 0-.85-1.352zm-5.146 14.861L10.826 12l7.178-5.448v10.896z","size":20,"color":"deepskyblue","viewBox":"0 0 24 24"},{"tag":"wordpress","tech":"Wordpress","name":"m5.8465 1.9131c0.57932 0 1.1068 0.222 1.5022 0.58547-0.1938-0.0052-0.3872 0.11-0.3952 0.3738-0.0163 0.5333 0.6377 0.6469 0.2853 1.7196l-0.2915 0.8873-0.7939-2.3386c-0.0123-0.0362 0.002-0.0568 0.0465-0.0568h0.22445c0.011665 0 0.021201-0.00996 0.021201-0.022158v-0.13294c0-0.012193-0.00956-0.022657-0.021201-0.022153-0.42505 0.018587-0.8476 0.018713-1.2676 0-0.0117-0.0005-0.0212 0.01-0.0212 0.0222v0.13294c0 0.012185 0.00954 0.022158 0.021201 0.022158h0.22568c0.050201 0 0.064256 0.016728 0.076091 0.049087l0.3262 0.8921-0.4907 1.4817-0.8066-2.3758c-0.01-0.0298 0.0021-0.0471 0.0308-0.0471h0.25715c0.011661 0 0.021197-0.00996 0.021197-0.022158v-0.13294c0-0.012193-0.00957-0.022764-0.021197-0.022153-0.2698 0.014331-0.54063 0.017213-0.79291 0.019803 0.39589-0.60984 1.0828-1.0134 1.8639-1.0134l-0.0000029-0.0000062zm1.9532 1.1633c0.17065 0.31441 0.26755 0.67464 0.26755 1.0574 0 0.84005-0.46675 1.5712-1.1549 1.9486l0.6926-1.9617c0.1073-0.3036 0.2069-0.7139 0.1947-1.0443h-0.000004zm-1.2097 3.1504c-0.2325 0.0827-0.4827 0.1278-0.7435 0.1278-0.2247 0-0.4415-0.0335-0.6459-0.0955l0.68415-1.9606 0.70524 1.9284v-1e-7zm-1.6938-0.0854c-0.75101-0.35617-1.2705-1.1213-1.2705-2.0075 0-0.32852 0.071465-0.64038 0.19955-0.92096l1.071 2.9285 0.000003-0.000003zm0.95023-4.4367c1.3413 0 2.4291 1.0878 2.4291 2.4291s-1.0878 2.4291-2.4291 2.4291-2.4291-1.0878-2.4291-2.4291 1.0878-2.4291 2.4291-2.4291zm0-0.15354c1.4261 0 2.5827 1.1566 2.5827 2.5827s-1.1566 2.5827-2.5827 2.5827-2.5827-1.1566-2.5827-2.5827 1.1566-2.5827 2.5827-2.5827z","size":20,"color":"green","viewBox":"3.5 1.5 5 5"},{"tag":"graphql","tech":"GraphQL","name":"M14.051 2.751l4.935 2.85c.816-.859 2.173-.893 3.032-.077.148.14.274.301.377.477.589 1.028.232 2.339-.796 2.928-.174.1-.361.175-.558.223v5.699c1.146.273 1.854 1.423 1.58 2.569-.048.204-.127.4-.232.581-.592 1.023-1.901 1.374-2.927.782-.196-.113-.375-.259-.526-.429l-4.905 2.832c.372 1.124-.238 2.335-1.361 2.706-.217.071-.442.108-.67.108-1.181.001-2.139-.955-2.14-2.136 0-.205.029-.41.088-.609l-4.936-2.847c-.816.854-2.171.887-3.026.07-.854-.816-.886-2.171-.07-3.026.283-.297.646-.506 1.044-.603l.001-5.699c-1.15-.276-1.858-1.433-1.581-2.584.047-.198.123-.389.224-.566.592-1.024 1.902-1.374 2.927-.782.177.101.339.228.48.377l4.938-2.85C9.613 1.612 10.26.423 11.39.088 11.587.029 11.794 0 12 0c1.181-.001 2.139.954 2.14 2.134.001.209-.03.418-.089.617zm-.515.877c-.019.021-.037.039-.058.058l6.461 11.19c.026-.009.056-.016.082-.023V9.146c-1.145-.283-1.842-1.442-1.558-2.588.006-.024.012-.049.019-.072l-4.946-2.858zm-3.015.059l-.06-.06-4.946 2.852c.327 1.135-.327 2.318-1.461 2.645-.026.008-.051.014-.076.021v5.708l.084.023 6.461-11.19-.002.001zm2.076.507c-.39.112-.803.112-1.192 0l-6.46 11.189c.294.283.502.645.6 1.041h12.911c.097-.398.307-.761.603-1.044L12.597 4.194zm.986 16.227l4.913-2.838c-.015-.047-.027-.094-.038-.142H5.542l-.021.083 4.939 2.852c.388-.404.934-.653 1.54-.653.627 0 1.19.269 1.583.698z","size":20,"color":"hotpink","viewBox":"0 0 24 24"},{"tag":"gatsby","tech":"Gatsby","name":"M12.001.007C5.326.007.007 5.326.007 12S5.326 23.995 12 23.995s11.994-5.319 11.994-11.994S18.676.007 12.001.007zM2.614 12.105l9.283 9.283c-5.111 0-9.283-4.172-9.283-9.283zm11.473 9.074L2.823 9.915C3.76 5.743 7.516 2.614 12 2.614a9.476 9.476 0 0 1 7.614 3.86L18.259 7.62a7.657 7.657 0 0 0-6.362-3.337A7.555 7.555 0 0 0 4.7 9.393l9.804 9.805c2.4-.835 4.276-2.92 4.798-5.424h-4.068v-1.773h6.154c0 4.485-3.129 8.24-7.301 9.178z","size":20,"color":"rebeccapurple","viewBox":"0 0 24 24"},{"tag":"steam","tech":"Steam","name":"m110.5 87.322c0 0.196 0 0.392 0.01 0.576l-28.508 41.412c-4.618-0.21-9.252 0.6-13.646 2.41-1.937 0.79-3.752 1.76-5.455 2.88l-62.599-25.77c0.00049 0-1.4485 23.83 4.588 41.59l44.254 18.26c2.222 9.93 9.034 18.64 19.084 22.83 16.443 6.87 35.402-0.96 42.242-17.41 1.78-4.3 2.61-8.81 2.49-13.31l40.79-29.15c0.33 0.01 0.67 0.02 1 0.02 24.41 0 44.25-19.9 44.25-44.338 0-24.44-19.84-44.322-44.25-44.322-24.4 0-44.25 19.882-44.25 44.322zm-6.84 83.918c-5.294 12.71-19.9 18.74-32.596 13.45-5.857-2.44-10.279-6.91-12.83-12.24l14.405 5.97c9.363 3.9 20.105-0.54 23.997-9.9 3.904-9.37-0.525-20.13-9.883-24.03l-14.891-6.17c5.746-2.18 12.278-2.26 18.381 0.28 6.153 2.56 10.927 7.38 13.457 13.54s2.52 12.96-0.04 19.1m51.09-54.38c-16.25 0-29.48-13.25-29.48-29.538 0-16.275 13.23-29.529 29.48-29.529 16.26 0 29.49 13.254 29.49 29.529 0 16.288-13.23 29.538-29.49 29.538m-22.09-29.583c0-12.253 9.92-22.191 22.14-22.191 12.23 0 22.15 9.938 22.15 22.191 0 12.254-9.92 22.183-22.15 22.183-12.22 0-22.14-9.929-22.14-22.183z","size":20,"color":"white","viewBox":"10 20 199 199"},{"tag":"nginx","tech":"Nginx","name":"M22.73015,49.008a3.59488,3.59488,0,0,1-7.18976,0l.00088.00088.00349-24.67727c0-1.91174,1.68924-3.49279,4.08175-3.49279a6.39282,6.39282,0,0,1,4.90021,2.191L25.613,24.32989,40.63124,42.30253V24.432H40.6295a3.59488,3.59488,0,0,1,7.18975,0h-.00087l-.00349,24.67552c0,1.91175-1.69011,3.49279-4.08175,3.49279a6.38857,6.38857,0,0,1-4.90021-2.191L22.7284,31.13659V49.0089Z","size":20,"color":"white","viewBox":"10 15 45 45"},{"tag":"bash","tech":"Bash","name":"","size":20,"color":"white","viewBox":"10 20 199 199"},{"tag":"game-server","tech":"Game Server","name":"","size":20,"color":"white","viewBox":"10 20 199 199"},{"tag":"security","tech":"Security","name":"","size":20,"color":"white","viewBox":"10 20 199 199"},{"tag":"spam","tech":"Spam","name":"","size":20,"color":"white","viewBox":"10 20 199 199"},{"tag":"sql","tech":"SQL","name":"","size":20,"color":"white","viewBox":"10 20 199 199"}]}},"allMarkdownRemark":{"totalCount":33,"edges":[{"node":{"excerpt":"Vor kurzem hatte ich einen Beitrag erstellt, der erklärt, wie man HTTPS inklusive Forward Security beim Nginx konfiguriert. Als nun Nachrichten von einer „neuen\" Lücke durch die Medien gingen, die…","html":"<p>Vor kurzem hatte ich einen Beitrag erstellt, der erklärt, wie man <a href=\"/https-und-forward-security-mit-nginx/\">HTTPS inklusive Forward Security beim Nginx konfiguriert</a>. Als nun Nachrichten von einer „neuen\" Lücke durch die Medien gingen, die nach Weltuntergang klangen, wie z.B. <a href=\"http://www.spiegel.de/netzwelt/web/logjam-sicherheitsluecke-gefaehrdet-zehntausende-websites-a-1034720.html\" target=\"_blank\" rel=\"external noopener noreferrer\">hier</a> und <a href=\"http://www.heise.de/security/meldung/Logjam-Attacke-Verschluesselung-von-zehntausenden-Servern-gefaehrdet-2657502.html\" target=\"_blank\" rel=\"external noopener noreferrer\">hier</a>, machte ich mir schon etwas sorgen.</p>\n<p>Zum Glück waren es nur reißerische Texte, die Klicks generieren sollten. Ob ihr selber betroffen seid, könnt ihr unter der URL <a href=\"https://weakdh.org/sysadmin.html\" target=\"_blank\" rel=\"external noopener noreferrer\">https://weakdh.org/sysadmin.html</a> nachprüfen. Diese Seite testet nur gegen Logjam. Einen ausführlicheren Test kann man unter <a href=\"https://www.ssllabs.com/ssltest/index.html\" target=\"_blank\" rel=\"external noopener noreferrer\">https://www.ssllabs.com/</a> ausführen lassen.</p>\n<p>Wer seinen Server nach gängigen Methoden und Erkenntnissen vor Bekannt werden von Logjam eingestellt hat, wird zumindest einen 2048bit Diffie-Hellman Parameter erstellt haben. In meinem voran gegangener Blogbeitrag hatte ich sogar 4096bit empfohlen.<br>\nHerausgefunden wurde nun, dass diejenigen betroffen sind, die keinen, oder zu schwachen Parameter benutzen. So sind 512bit wohl sehr einfach, 768bit schafft wohl jeder etwas stärkere CPU Verbund und für 1024bit muss wohl ein etwas größeres Cluster her.</p>\n<p>Mit anderen Worten sind wieder einmal nur diejenigen betroffen, die ihre Server, aus welchen Gründen auch immer, nachlässig betreuen.</p>","id":"de609d3c-c5d2-5d04-99b6-9bcb01fa4178","frontmatter":{"title":"The Logjam Attack","date":"2015-05-23","tags":["security"]},"fields":{"slug":"/the-logjam-attack/"},"timeToRead":1}},{"node":{"excerpt":"Beim Kontrollieren meiner Logs musste ich heute feststellen, dass ein Botnetz versucht hat und immer noch dabei war, das XML-RPC Feature meiner WordPress Installation für Angriffe auf andere Server…","html":"<p>Beim Kontrollieren meiner Logs musste ich heute feststellen, dass ein Botnetz versucht hat und immer noch dabei war, das XML-RPC Feature meiner WordPress Installation für Angriffe auf andere Server auszunutzen.</p>\n<p>Die Versuche wurden zwar von der Nginx WAF NAXSI geblockt, die Logs sind dennoch explodiert. Das wird wohl auch damit zusammenhängen, dass hier fast 3500 Bots am Werke sind:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">grep</span> <span class=\"token string\">'xmlrpc.\nphp'</span> error.log error.log.1 <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print $7}'</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F <span class=\"token string\">'&amp;'</span> <span class=\"token string\">'{print $1}'</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F <span class=\"token string\">'='</span> <span class=\"token string\">'{print $2}'</span> <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> -u <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> -l\n<span class=\"token operator\">></span> <span class=\"token number\">3462</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Die Gesamtanzahl der Aufrufe je IP ist relativ gering. Die Angreifer versuchen dadurch wohl unter dem Radar von etwaigen Rate Limiting durchzufliegen:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">grep</span> <span class=\"token string\">'xmlrpc.php'</span> error.log error.log.1 <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> -l\n<span class=\"token operator\">></span> <span class=\"token number\">22853</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Ich benutze das XML-RPC Feature bei diesem Blog nicht. Deswegen hatte ich die xmlrpc.php auch vor einiger Zeit gelöscht. Durch ein Update wurde sie aber wieder eingespielt und ich hatte vergessen sie abermals zu entfernen.</p>\n<p>Ich hatte nun zwei Ziele. Zum einen, will ich den Zugriff auf die xmlrpc.php sperren, egal, ob sie existiert, oder nicht. Die CPU Leistung, die die WAF zum Blocken braucht, muss man ja nicht unnötig aufwenden. Zum zweiten, sollen die Zugriffe nicht mehr geloggt werden. Falls es den Bedarf einer genaueren Analyse geben sollte, kann man das Logging ja nachträglich wieder aktivieren.</p>\n<p>Um die Ziele zu erreichen habe ich eine neue Location in den Vhost an erster Stelle, noch vor dem Block \"location /\", eingetragen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">location ~ xmlrpc.php {\n    access_log off;\n    error_log /dev/null crit;\n    deny all;\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"58a6734a-a229-5a6e-9321-44bac8523955","frontmatter":{"title":"WordPress XML-RPC Angriff","date":"2014-07-20","tags":["wordpress","security"]},"fields":{"slug":"/wordpress-xml-rpc-angriff/"},"timeToRead":1}},{"node":{"excerpt":"Vor ein paar Tagen gab es ein Problem durch einen Denial Of Service (DOS). Einer der unzähligen SEO Agenturen crawlte die betroffene Seite mehr aggressiv. Die robots.txt wurde dabei natürlich…","html":"<p>Vor ein paar Tagen gab es ein Problem durch einen Denial Of Service (DOS). Einer der unzähligen SEO Agenturen crawlte die betroffene Seite mehr aggressiv. Die robots.txt wurde dabei natürlich ignoriert.</p>\n<p>Der Unterschied eines DOS zu einem DDOS liegt darin, dass hier die CPU, Ram bzw. Festplatte überlastet werden, während man bei einem DDOS die Bandbreite der Server überlastet. So kann bei einem DOS schon eine kleine 1000er DSL Leitung reichen, wenn man eine Unterseite auf dem Server identifizieren kann, die die Hardware des Servers an seine Grenzen bringt.</p>\n<p>Im konkreten Fall war ein etwas größeres Setup betroffen, das mit Hardware Load Balancer, mehreren App Servern, die auf ein DB Cluster und spezielle Suchserver zugreifen, arbeitet. Auf den App Servern läuft dabei der Nginx als Webserver. Im Grunde also ein recht Leistungsstarkes System.</p>\n<p>Damit der Traffik gar nicht erst bei den App Servern ankommt, wäre hier die beste Lösung die aggressive IP direkt am Load Balancer zu sperren. Im konkreten Fall war das aber auf Grund zwingender Prozesse, Zuständigkeiten und der Urlaubszeit leider nicht auf die Schnelle möglich.</p>\n<p>Ein schneller Workaround musste also her. Da zu dem Zeitpunkt noch nicht ganz klar war, wie viele IPs beteiligt sind bzw. sein werden und die SEO Agentur ihren Bot klar über den User Agent erkennbar machte, wurde eine Sperre über den User Agent implementiert. Recht weit oben im Server Block wurde folgendes eingetragen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">if ($http_user_agent ~* (BadBot) ) { return 403;}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nach dem Eintragen, wurde die Config getestet und, da der Syntax akzeptiert wurde, der Server neu geladen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/etc/init.d/nginx configtest\n/etc/init.d/nginx reload</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Nachdem die Änderung ging der Load sofort zurück. Da man die Logs nicht mit hundert tausenden Logeinträgen des Bots voll haben wollte, noch das Logging deaktivieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">if ($http_user_agent ~* (BadBot) ) {\n access_log /dev/null;\n error_log /dev/null crit;\n return 403;\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Eine Lösung über die IP empfiehlt es sich eine extra Datei mit der Liste an bösen IPs anzulegen und diese dann zu includen. In der Liste sehen Einträge dann so aus:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">\n# Blocke einzelne IP\ndeny 1.2.3.4;\n\n# Blocke ein ganzes Subnetz\ndeny 1.2.3.0/24;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Der Include im server Block:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">include /etc/nginx/bad_ips.conf;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Wenn Nginx hinter einem Load Balancer ist, muss man noch auf den X-Forwarded-For Header zugreifen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Hier die Load Balancer IP angeben\nset_real_ip_from 1.1.1.1;\nreal_ip_header X-Forwarded-For;\n// Die Liste includen\ninclude /etc/nginx/bad_ips.conf;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Mit dieser Lösung kann man aber immer nur reagieren, wenn es bereits zu spät, und der Service beeinträchtigt ist. Um einen Denial Of Service von vornherein zu erschweren, kann man bei Nginx mit Rate Limiting arbeiten. Dabei sollte man zwischen Location für statische und dynamisch Inhalte unterscheiden. Ein zu strenges Limit auf JS, Bilder etc. kann den Seitenaufbau verzögern, oder sogar verhindern.</p>\n<p>Zuerst erstellen wir im http block in der <em>/etc/nginx/nginx.conf</em> die Limit Zonen <em>static</em> und <em>dynamic</em></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">limit_req_zone $binary_remote_addr zone=static:20m rate=20r/s;\nlimit_req_zone $binary_remote_addr zone=dynamic:20m rate=10r/s;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>In der Location für die Zugriffe, auf Rails, PHP, NodeJS, oder wie man dynamische Inhalte auch immer ansprechen möchte, aktiviert man dann die vorher definierte Zone. Dabei habe ich hier einen Burst von 20 Zugriffen erlaubt. Der Zusatz <em>nodelay</em> hat zur Folge, dass bei Erreichen des Limits mit 403 geantwortet wird, wenn das Limit erreicht wurde. Ohne den Zusatz wird mit der Antwort geantwortet, bis eine Antwort wieder erlaubt wäre. Wenn man mit Anfragen bombadiert wird, kann es zu hunderten, wenn nicht gar tausenden offenen Verbindungen kommen, wenn man <em>nodelay</em> weg lässt. Das folgende Beispiel wäre für PHP:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">\nlocation ~ \\.php$ {\n   limit_req zone=dynamic burst=20 nodelay;\n   include /etc/nginx/fastcgi_params;\n   fastcgi_pass unix:/tmp/php5-fpm.sock;\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Wenn Nginx hinter einem Load Balancer steht, muss man auch hier mit <em>real_ip_header</em> arbeiten. Ansonsten werden sehr schnell, sämtliche Anfragen blockiert.</p>","id":"48e6bc8f-06e1-5ef9-8ab1-37060af8ba6a","frontmatter":{"title":"Nginx: Denial Of Service Abwehr","date":"2014-06-14","tags":["security","nginx"]},"fields":{"slug":"/nginx-denial-service-abwehr/"},"timeToRead":3}},{"node":{"excerpt":"Was viele nicht wissen und bei vielen Tutorials ausgelassen wird, ist das nützliche Tool mysql_secure_installation MariaDB ist bei Debian einfach zu installieren: Ebenso MySQL: Was viele nicht wissen…","html":"<p>Was viele nicht wissen und bei vielen Tutorials ausgelassen wird, ist das nützliche Tool <em><strong>mysql_secure_installation</strong></em></p>\n<p>MariaDB ist bei Debian einfach zu installieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mariadb-server mariadb-client</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Ebenso MySQL:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mysql-server mysql-client</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Was viele nicht wissen, und was die wenigsten Tutorials beinhalten ist der anschließende Aufruf des Tools <em><strong>mysql_secure_installation</strong></em>. Die Anwendung ist einfach und sorgt dafür dass unnötige Testzugänge und zu lockere Rechte abgestellt werden:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">root@somehost:/home/phpuser/www<span class=\"token comment\"># mysql_secure_installation</span>\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB\n      SERVERS IN PRODUCTION USE<span class=\"token operator\">!</span>  PLEASE READ EACH STEP CAREFULLY<span class=\"token operator\">!</span>\n\nIn order to log into MariaDB to secure it, we<span class=\"token string\">'ll need the current\npassword for the root user.  If you'</span>ve just installed MariaDB, and\nyou haven<span class=\"token string\">'t set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MariaDB\nroot user without the proper authorisation.\n\nYou already have a root password set, so you can safely answer '</span>n<span class=\"token string\">'.\n\nChange the root password? [Y/n] n\n ... skipping.\n\nBy default, a MariaDB installation has an anonymous user, allowing anyone\nto log into MariaDB without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] y\n ... Success!\n\nNormally, root should only be allowed to connect from '</span>localhost<span class=\"token string\">'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] y\n ... Success!\n\nBy default, MariaDB comes with a database named '</span><span class=\"token builtin class-name\">test</span><span class=\"token string\">' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] y\n - Dropping test database...\nERROR 1008 (HY000) at line 1: Can'</span>t drop database <span class=\"token string\">'test'</span><span class=\"token punctuation\">;</span> database doesn<span class=\"token string\">'t exist\n ... Failed!  Not critical, keep moving...\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] y\n ... Success!\n\nCleaning up...\n\nAll done!  If you'</span>ve completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks <span class=\"token keyword\">for</span> using MariaDB<span class=\"token operator\">!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"e983707b-176e-55d1-835a-c5bfce3ab9ca","frontmatter":{"title":"MySQL/MariaDB mit mysql_secure_installation absichern","date":"2013-12-31","tags":["security","sql","MySQL","MariaDB"]},"fields":{"slug":"/mysqlmariadb-mit-mysql_secure_installation-absichern/"},"timeToRead":2}},{"node":{"excerpt":"Diese Woche war auf so ziemlich jedem Newsportal, wie z.B. heise.de zu lesen, dass der Nginx Webserver eine Sicherheitslücke hat, durch die man Code einschleusen kann. Zu dem Fix wurde gleichzeitig…","html":"<p>Diese Woche war auf so ziemlich jedem Newsportal, wie z.B. <a href=\"http://www.heise.de/security/meldung/Leerzeichen-tricksen-Nginx-aus-2050731.html\" target=\"_blank\" rel=\"external noopener noreferrer\">heise.de</a> zu lesen, dass der Nginx Webserver eine Sicherheitslücke hat, durch die man Code einschleusen kann.</p>\n<p>Zu dem Fix wurde gleichzeitig ein Workaround veröffentlicht, damit die Webserver geschützt sind, bis die Distributions Maintainer wie Debian, CentOS, usw. den Fix an ihre User weiterreichen.</p>\n<p>Als Workaround wurde empfohlen folgenden Eintrag in den server Blöcken einzutragen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">if ($request_uri ~ \" \") {\n   return 444;\n} </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Der Fix ist nun zumindest bei Debian und beim inoffiziell Dotdeb Repository angekommen. Es heißt also folgendes auszuführen:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt-get</span> upgrade</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Es ist leider zu befürchten, dass in nächster Zeit die Anzahl der erfolgreichen Hacks ansteigen wird, zumal viele Serverbesitzer oft nicht zeitnah reagieren und Nginx mittlerweile auch bei Plesk dabei ist.</p>","id":"5ed1b1eb-5185-5eef-9557-db641ed785ce","frontmatter":{"title":"Sicherheitslücke im Nginx: so schnell wie möglich updaten","date":"2013-11-23","tags":["security","nginx"]},"fields":{"slug":"/sicherheitsluecke-im-nginx-schnell-wie-moeglich-updaten/"},"timeToRead":1}},{"node":{"excerpt":"Wie mittlerweile auch heise berichtet, wurde der Hoster zap-hosting erfolgreich angegriffen. Bisher gibt es nur die Informationen, die der Angreifer auf der defaceten Seite hinterlassen hat. Laut…","html":"<p>Wie mittlerweile auch <a href=\"http://www.heise.de/newsticker/meldung/Angriff-auf-zap-hosting-com-1909531.html\" target=\"_blank\" rel=\"external noopener noreferrer\">heise</a> berichtet, wurde der Hoster zap-hosting erfolgreich angegriffen.</p>\n<p>Bisher gibt es nur die Informationen, die der Angreifer auf der defaceten Seite hinterlassen hat. Laut dessen Aussage wurden wurden wohl nur einfache Passwörter und diese mehrfach verwendet.</p>\n<p>Die zusätzliche Aussage, dass der Standardport ein Risiko sein soll irritiert aber etwas. Port verlegen fällt eher in den Bereich Security by Obscurity. \"<em>man nmap</em>\" und man sollte in der Lage sein, den verstellten Port zu finden.</p>\n<p>Wirklich bedauerlich ist der Umstand, dass der Hoster erst jetzt Geld in die Sicherheit investieren will, wo es bereits zu spät ist:<br>\n<a href=\"https://www.facebook.com/zaphosting/posts/627629073927886\" title=\"Facebook Post\" target=\"_blank\" rel=\"external noopener noreferrer\">Facebook Post</a></p>\n<p>Die Aktion fällt leider nicht mehr in den Bereich White Hat Hacker. Verantwortungsvoller wäre es gewesen den Hoster über die Probleme zu informieren und nach einer angemessenen Zeit gegebenenfalls einen Public Disclosure zu machen. Listen dafür gibt es ja genügend. Eine wäre<br>\n<a href=\"http://seclists.org/fulldisclosure/\" title=\"http://seclists.org/fulldisclosure/\" target=\"_blank\" rel=\"external noopener noreferrer\">seclists.org/fulldisclosure/</a></p>","id":"4e65883f-6f2b-55e4-bc19-cfd32594d786","frontmatter":{"title":"Angriff auf zap-hosting.com","date":"2013-07-02","tags":["security"]},"fields":{"slug":"/angriff-auf-zap-hosting-com/"},"timeToRead":1}},{"node":{"excerpt":"So wie es scheint gehen die Angriffe auf WordPress Blogs in die nächste Runde. Ich musste eben das Wordfence Plugin umstellen, damit es mich nicht mehr mit E-Mails zuspammt. Bisher wurde ich über…","html":"<p>So wie es scheint gehen die Angriffe auf WordPress Blogs in die nächste Runde. Ich musste eben das Wordfence Plugin umstellen, damit es mich nicht mehr mit E-Mails zuspammt. Bisher wurde ich über jeden fehlgeschlagenen Versuch ein Passwort zurückzusetzen, oder einen fehlgeschlagenen Loginversuch informiert. Innerhalb weniger Minuten hatte ich auf einmal über 600 Mails im Posteingang. Jede war für einen eigene Bot bzw. IP.</p>\n<p>Per Brutforce wird versucht die hier nicht mehr vorhandenen Accounts <strong>admin</strong>, <strong>adminadmin</strong> und <strong>administrator</strong> zu knacken.</p>\n<p>Der Angriff geht weiter, wenigstens werde ich nicht mehr mit Warnungen bombardiert. Den aktuellen Stand kann ich mit diesem Query nachvollziehen:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">`</span>IP<span class=\"token punctuation\">`</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token punctuation\">`</span>attackerCount<span class=\"token punctuation\">`</span><span class=\"token punctuation\">,</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">`</span>IP<span class=\"token punctuation\">`</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">`</span>blockedHits<span class=\"token punctuation\">`</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token punctuation\">`</span>totalAttacks<span class=\"token punctuation\">`</span> <span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">`</span>wp_wfLockedOut<span class=\"token punctuation\">`</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nur 10 Minuten, nachdem ich das Mail Versenden ausgestellt hatte, ist das Ergebnis:</p>\n<blockquote>\n<p>attackerCount: 1573<br>\ntotalAttacks: 4927</p>\n</blockquote>","id":"9455e924-b257-599d-aea9-b34020cb55e7","frontmatter":{"title":"Grüße von einem Botnetz","date":"2013-05-30","tags":["wordpress","security"]},"fields":{"slug":"/gruse-von-einem-botnetz/"},"timeToRead":1}},{"node":{"excerpt":"Das man Passwörter nicht ungesichert in die Datenbank schreiben sollte, hat sich sicher mittlerweile herumgesprochen. Falls eine Webseite einem das aktuelle Passwort zuschicken kann, würde ich meine…","html":"<p>Das man Passwörter nicht ungesichert in die Datenbank schreiben sollte, hat sich sicher mittlerweile herumgesprochen. Falls eine Webseite einem das aktuelle Passwort zuschicken kann, würde ich meine Daten dort sofort löschen lassen. Der Grund ist, dass hier keine, oder eine absolut ungenügende Sicherung der Passwörter erfolgt.</p>\n<p>Um Datendieben die Passwörter nicht auf dem Silbertablett zu servieren, ist es deswegen üblich geworden, Passwörter zu hashen. Die mittlerweile zu bevorzugende Methode ist das Hashen mittels Bcrypt wobei zusätzlich ein Salt und Iteration zum Einsatz kommt.</p>\n<p>Vor einigen Jahren, war es normal, Passwörter lediglich mit MD5, oder SHA1 zu hashen und auf die Verwendung von Salts und Iteration zu verzichten. Mit wachsender Rechenleistung von CPUs und Grafikkarten ist es immer einfacher geworden Millionen, wenn nicht sogar Milliarden von Hashes je Sekunde durchzuprobieren.<br>\nSo schafft zum Beispiel <a href=\"http://www.heise.de/security/meldung/Rekorde-im-Passwort-Knacken-durch-Riesen-GPU-Cluster-1762654.html\" target=\"_blank\" rel=\"external noopener noreferrer\">dieses GPU Cluster</a> 180 Milliarden MD5 und 63 Milliarden SHA1 Hashes in der Sekunde zu erstellen. Fällt erst einmal die Userdatenbank in falsche Hände, sind auch sichere Passwörter schnell gecrackt.<br>\nAus diesem Grund werden MD5 und SHA1 als kaputte Sicherheitsmaßnahmen angesehen.</p>\n<p>Wenn man kein Programmierer ist und herausfinden möchte, ob das eingesetzte CMS, Interface, Forum, usw. die Passwörter unsicher speichert, braucht man lediglich Zugriff zur Datenbank.</p>\n<p>Man öffnet die Benutzer Tabelle und sucht nach der Spalte für das Passwort. MD5 Hashes sind 32 und SHA1 40 Stellen lang. Beide enthalten nur Zahlen und klein geschriebene Buchstaben.</p>\n<p>Man hat nun zwei Möglichkeiten, um zu testen, ob lediglich ein einfacher Hash zum Einsatz kommt.<br>\nDie einfachste Version ist es, den Hash zu seinem aktuellen Passwort mit einem <a href=\"http://www.hashgenerator.de/\" target=\"_blank\" rel=\"external noopener noreferrer\">Online Generator</a> zu erstellen und den generierten mit dem hinterlegten zu vergleichen.<br>\nDie andere wäre es, den Hash zu einem bekannten Passwort einzutragen und den Login zu versuchen.</p>\n<p>Ist das Passwort unsicher gespeichert, sollte man die Benutzung der Software einstellen und auf eine andere ausweichen, weil ein seit Jahren bekanntes Sicherheitsproblem ignoriert wurde.</p>","id":"98edb3cc-cd9a-5b4b-84b7-3b365b89ed89","frontmatter":{"title":"Wie man unsicher gehashte Passwörter erkennt","date":"2012-12-08","tags":["security"]},"fields":{"slug":"/wie-man-unsicher-gehashte-passworter-erkennt/"},"timeToRead":1}},{"node":{"excerpt":"Das CMS Webspell hat, wie so ziemlich jedes andere CMS auch, mit Spammern zu kämpfen. Der Clan myRevenge e.V. setzt Webspell ein und hat mich um Hilfe mit ihrem Spam Problem gebeten. Trotz Captcha und…","html":"<p>Das CMS <a href=\"http://www.webspell.org\" target=\"_blank\" rel=\"external noopener noreferrer\">Webspell</a> hat, wie so ziemlich jedes andere CMS auch, mit Spammern zu kämpfen. Der Clan <a href=\"http://www.myrevenge.net\" target=\"_blank\" rel=\"external noopener noreferrer\">myRevenge e.V.</a> setzt Webspell ein und hat mich um Hilfe mit ihrem Spam Problem gebeten. Trotz Captcha und Bestätigungslink schaffen es Spammer immer wieder sich anzumelden oder als Gast zu spammen. Nach einer erfolgreichen Anmeldung wird im zweiten Schritt auch in Bereichen gespmamt, in denen Gäste keine Schreibrechte haben.</p>\n<p>Um den Spam einzudämmen, bietet sich eine Überprüfung an, wer so schreibt. Dabei macht man sich zu Nutze, dass Spammer wiederkehrende E-Mail Adressen und Usernamen verwenden.</p>\n<p>Im ersten Schritt werden unerwünschte Top Level Domains und Domainendungen in 2 Arrays übergeben und überprüft, ob die verwendete E-Mail einen dieser Kriterien entspricht. Weil Spammer sehr flexibel sind, stellt diese Maßnahme lediglich einen Tropfen auf den heißen Stein dar.</p>\n<p>Wesentlich effizienter ist der zweite Schritt. Hier wird die API von <a href=\"http://stopforumspam.com\" target=\"_blank\" rel=\"external noopener noreferrer\">stopforumspam.com</a> kontaktiert und gefragt, ob Name, oder E-Mail bereits als Spammer bekannt sind. Stopforumspam.com ist eine Seite, die bekannte Spammer sammelt und nicht kommerziellen Nutzern eine API zu der Datenbank anbietet.<br>\nNur wenn die API antwortet, dass der Datensatz unbekannt ist, darf der User sich anmelden, bzw. einen Kommentar schreiben.</p>\n<p>Die beschriebenen Ergänzungen werden in den Dateien register.php und comments.php vorgenommen.</p>\n<p>Die Erweiterung der register.php:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// check e-mail</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">validate_email</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$error</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token variable\">$_language</span><span class=\"token operator\">-></span><span class=\"token property\">module</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'invalid_mail'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// Liste mit unzulaessigen Maildomains</span>\n\t<span class=\"token variable\">$badmaildomains</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'willich.nicht'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'auchnicht.de'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Liste mit unzulaessigen TLs array('cn','xxx')</span>\n\t<span class=\"token variable\">$badtld</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Useraccount von Domain trennen</span>\n\t<span class=\"token keyword\">list</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'@'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Top Level herausfinden</span>\n\t<span class=\"token variable\">$domain_explode</span><span class=\"token operator\">=</span><span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'.'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$last_array_entry</span><span class=\"token operator\">=</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain_explode</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Überpruefen, ob die Domain geblacklisted ist</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$badmaildomains</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain_explode</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$last_array_entry</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$badtld</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$error</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token variable\">$_language</span><span class=\"token operator\">-></span><span class=\"token property\">module</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'invalid_mail'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// Stopforumspam kontaktieren:</span>\n\t\t<span class=\"token variable\">$opts</span><span class=\"token operator\">=</span><span class=\"token function\">stream_context_create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http'</span><span class=\"token operator\">=></span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'method'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'GET'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'header'</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"Accept-language: en\\r\\nUser-Agent: \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_HOST'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$contact_stopforumspam</span><span class=\"token operator\">=</span>@<span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://www.stopforumspam.com/api?email[]='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&amp;username[]='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&amp;username[]='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$nickname</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$opts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$contact_stopforumspam</span><span class=\"token operator\">!=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$xmlreply</span> <span class=\"token operator\">=</span> <span class=\"token function\">simplexml_load_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$contact_stopforumspam</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xmlreply</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$xml_key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$xmlcheck</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token comment\">// Wenn der Spammer in der Datenbank erfasst ist, feststellen, ob die Mail und oder der Username bekannt war und einen entsprechenden Fehler ausgeben</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xmlcheck</span><span class=\"token operator\">-></span><span class=\"token property\">appears</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xml_key</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'email'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token variable\">$error</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token variable\">$_language</span><span class=\"token operator\">-></span><span class=\"token property\">module</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'invalid_mail'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xml_key</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token variable\">$error</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token variable\">$_language</span><span class=\"token operator\">-></span><span class=\"token property\">module</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'nickname_inuse'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Und die Änderung in der comments.php:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">IsNoSpammer</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$useragent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$nospammer</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Liste mit unzulaessigen Maildomains</span>\n\t<span class=\"token variable\">$badmaildomains</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'willich.nicht'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'auchnicht.de'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Liste mit unzulaessigen TLs array('cn','xxx')</span>\n\t<span class=\"token variable\">$badtld</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Useraccount von Domain trennen</span>\n\t<span class=\"token keyword\">list</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'@'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Top Level herausfinden</span>\n\t<span class=\"token variable\">$domain_explode</span><span class=\"token operator\">=</span><span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'.'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$last_array_entry</span><span class=\"token operator\">=</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain_explode</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Überpruefen, ob die Domain geblacklisted ist</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$badmaildomains</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$domain_explode</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$last_array_entry</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$badtld</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$nospammer</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token variable\">$opts</span><span class=\"token operator\">=</span><span class=\"token function\">stream_context_create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http'</span><span class=\"token operator\">=></span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'method'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'GET'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'header'</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"Accept-language: en\\r\\nUser-Agent: \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$useragent</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$contact_stopforumspam</span><span class=\"token operator\">=</span>@<span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://www.stopforumspam.com/api?email[]='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&amp;username[]='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$opts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$contact_stopforumspam</span><span class=\"token operator\">!=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$xmlreply</span> <span class=\"token operator\">=</span> <span class=\"token function\">simplexml_load_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$contact_stopforumspam</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xmlreply</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$xml_key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$xmlcheck</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token comment\">// Wenn der Spammer in der Datenbank erfasst ist, $nospammer auf false setzen</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$xmlcheck</span><span class=\"token operator\">-></span><span class=\"token property\">appears</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token variable\">$nospammer</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$nospammer</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IsNoSpammer</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mail</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_HOST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// hier den DB Eintrag vornehmen.</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"d2125e22-3d1a-5700-b2a6-67915d020426","frontmatter":{"title":"Spammer, Webspell und Stopforumspam.com","date":"2012-01-27","tags":["spam","security","php","Webspell"]},"fields":{"slug":"/spammer-webspell-und-stopforumspam-com/"},"timeToRead":2}},{"node":{"excerpt":"Möchte man als Hoster bei der ESL als zertifizierter Hoster geführt werden, muss er seinen Kunden ein Webinterface bereitstellen, dass den genannten Protection Mode unterstützt. beim…","html":"<p>Möchte man als Hoster bei der <a href=\"http://esl.eu\" target=\"_blank\" rel=\"external noopener noreferrer\">ESL</a> als zertifizierter Hoster geführt werden, muss er seinen Kunden ein Webinterface bereitstellen, dass den genannten <em>Protection Mode</em> unterstützt. beim Zulassungsverfahren wurde bisher eine PDF versandt, die nur recht Wage aufgelistet hat, welche Maßnahmen man ergreifen kann, damit der Server als sicher eingestuft wird. Das man hier keine genauen Vorschriften machen kann, was genau, auf welche Art umzusetzen ist, liegt in der Natur der Sache. Jedes Interface arbeitet anders. Das die Vorgabe sehr wage sind, kann man der ESL deswegen nicht vorwerfen. Es ist somit die Verantwortung der Webinterface Entwickler eine Lösung für ihren Spezialfall zu schaffen.</p>\n<p>Was hingegen teilweise auf die Kappe der ESL geht, ist der Umstand, dass sich über mögliche Angriffswege ausgeschwiegen wurde. Nicht jeder Coder kennt sich in den Eigenarten einzelner Gameserver aus, oder verfolgt die Diskussionen zu diesen. Wenn er sich nur auf die ESL verlässt und auf den Rat von Dritten verzichtet, wird er wichtige Dinge übersehen. Wenn er jedoch Hinweise Dritter bewusst übergeht, ist eine fehlerhafte Umsetzung alleinig ihm anzulasten.</p>\n<p>Da es bis heute keine zusammenfassende Auflistung über mögliche Angriffswege und Abwehrmaßnahmen gibt, habe ich nun im Rahmen meiner ehrenamtlichen Tätigkeit bei der ESL einen Vorschlag für eine Richtlinie erarbeitet und diese an die ESL weitergeleitet. Ob und in welcher Form mein Vorschlag übernommen wird, ist Sache der ESL.</p>\n<p>Auch unabhängig vom Protection Mode ist es sicherlich interessant, über welche Wege Kunden ihre Server anderes betreiben können, als vom Anbieter vorgesehen.</p>\n<p>Viele der Punkte gibt es schon seitdem es Gameserver gibt und sind versierten Anwendern ebenso lange bekannt. Dennoch werden sie leider immer wieder übersehen.</p>\n<p>Im folgenden nun mein Vorschlag einer Richtlinie für den Protection Mode</p>\n<h3>Ziel</h3>\n<p>Der Server, der unter der angegebenen Adresse (IP:Port) erreicht wird, darf außer den Servertools eslplugin und zblock keine weiteren Servertools geladen haben.</p>\n<h3>Angriffswege , die nicht funktionieren dürfen</h3>\n<h4>1. Upload in das geschütze Verzeichnis</h4>\n<p>Der User darf nicht in der Lage sein, Servertools in die Verzeichnisse des geschützen Server zu laden und von dort auszuführen.</p>\n<h4>2. plugin_load</h4>\n<p>Das Ausführen des Servercommands \"plugin_load\" muss verhindert werden. Dabei ist auch zu beachten, das die *.so Dateien des Servers manipuliert werden können, so dass der Befehl unter dem Beispielnamen \"plg1n_load\" läuft. Über das deaktivieren des Befehls hinaus, muss deswegen sicher gestellt sein, dass der Benutzer die *.so des Servers nicht verändern kann.</p>\n<h4>3. Änderung der ausführbaren Dateien</h4>\n<p>Mittels eines FTP Client und Editor können Änderungen an den Startskripten , ausgeführten Binaries und den *.so in den bin/ Ordern der Server gemacht werden. Des Weiteren kann man diese Änderungen auch mit Servertools wie Sourcemod und Eventscript herbeiführen.<br>\nDiese Veränderungen müssen sowohl beim geschützten, als auch ungeschützen Server entweder rückgängig, oder von vornherein verhindert werden.</p>\n<h4>4. (Reverse) Shells</h4>\n<p>Manche Servertools können Shells bereitstellen, mit denen man Prozesse vom Gameserverprozess losgelöst starten kann. Diese Prozesse müssen beim Start des Protected Modes beim normalen User beendet werden.</p>\n<h4>5. Folgen von Punkt 3 und 4</h4>\n<p>Ein nach den Punkt 3 oder 4 kompromitierter ungeschützter Server kann auch durch eine Firewall hindurch eine Reverse Shell aufbauen. Wenn diese beim Start des Protected Modes nicht erkannt wird, kann man die Adresse des geschützten Servers mit einem ungeschützten belegen.<br>\nEine Belegung der Adresse kann ebenso mit Endlosschleifen und Cronjobs erreicht werden.<br>\nEs müssen deswegen alle ungewollten Cronjobs und Prozesse beim Benutzer des ungeschützten Servers beendet werden, bevor der protected Server gestartet wird. Es darf nicht möglich sein, dass die Adresse voin einem anderen Prozess, als dem geschützten benutzt wird.</p>\n<h3>Mögliche Maßnahmen</h3>\n<p>Folgende Maßnahmen müssen nicht alle umgesetzt werden. Sie sind lediglich eine Liste von Dingen, mit denen man das Ziel erreichen kann.</p>\n<ol>\n<li>Strenge Chmods</li>\n<li>Zugriffseinschränkungen und Dateifilter am FTP Server</li>\n<li>Prozess und Port Kontrolle</li>\n<li>Verbieten des Befehls plugin_load</li>\n<li>Überprüfung kritischer Serverdateien vor jedem Serverstart sowohl im Protected Mode als auch im Unprotected Mode</li>\n<li>Ohne Differenzierung alle Prozesse des ungeschützten Users beim Start des Protection Modes killen</li>\n<li>Die Server mit unterschiedlichen Usern starten. Dabei sollte unter keinen Umständen ein User mit Root, oder Sudo Rechten den Prozesse ausführen.</li>\n<li>Für jeden Gameserverprozess ein eigenes Chroot</li>\n</ol>\n<h3>Zusätzlicher Hinweis</h3>\n<p>Es gibt keine wirksamen Maßnahmen gegen Shellplugins. Im Extremfall könnte dies ausgenutzt werden, um über veralterte Pakete oder Kernel Rootrechte erlangt werden. Es ist deswegen darauf zu achten, dass der Server nicht über bekannte Exploits von innen angreifbar ist.</p>","id":"33de969d-b75a-5083-b594-4fe4f5793e10","frontmatter":{"title":"Vorschlag einer genaueren Protection Mode Richtlinie der ESL","date":"2012-01-07","tags":["ESL","game-server","security"]},"fields":{"slug":"/vorschlag-einer-genaueren-protection-mode-richtlinie-der-esl/"},"timeToRead":3}},{"node":{"excerpt":"Wenn man Systemupdates gerne schleifen lässt, wäre es derzeit vielleicht nicht schädlich, wenn man diese Gewohnheit etwas aussetzt. In den letzten Tagen und Wochen sind mehrere Updates erschienen, die…","html":"<p>Wenn man Systemupdates gerne schleifen lässt, wäre es derzeit vielleicht nicht schädlich, wenn man diese Gewohnheit etwas aussetzt. In den letzten Tagen und Wochen sind mehrere Updates erschienen, die sicherheitstechnisch wichtig sind.</p>\n<p>Angefangen beim <a href=\"http://bugs.proftpd.org/show_bug.cgi?id=3711\" target=\"_blank\" rel=\"external noopener noreferrer\">ProFTPD Server</a>, bei dem eine Lücke entdeckt wurde, mit der es möglich ist, von außen Code einzuschleusen, ohne Zugangsdaten zu benötigen (remote code execution).</p>\n<p><a href=\"http://www.debian.org/security/2011/dsa-2347\" target=\"_blank\" rel=\"external noopener noreferrer\">Bind9</a> hat ebenfalls eine schwere Lücke, mittels der der Angreifer den Deamon zum Absturz bringen kann (denial of service).</p>\n<p>Des Weiteren ist <a href=\"http://www.sourcebans.net/content/sourcebans-149-released\" target=\"_blank\" rel=\"external noopener noreferrer\">Sourcebans</a> nun in der Version 1.4.9 erschienen. Dieses Update behebt einige Bugs und die Möglichkeit einer SQL Injection.</p>","id":"6343316b-8d9c-5d2d-bb80-6dea48026cc6","frontmatter":{"title":"Zeit mal wieder zu updaten","date":"2011-11-19","tags":["security"]},"fields":{"slug":"/zeit-mal-wieder-zu-updaten/"},"timeToRead":1}},{"node":{"excerpt":"Ich bin vorhin über ein Youtube Video gestolpert. In ihm wird aufgezeigt, wie man das Blockieren des \"plugin_load\" Befehls bei Half-Life 2 basierenden Servern wie Counter-Strike: Source aushebeln kann…","html":"<p>Ich bin vorhin über ein <a href=\"http://www.youtube.com/watch?v=wks2QLiIOuc\" target=\"_blank\" rel=\"external noopener noreferrer\">Youtube Video</a> gestolpert. In ihm wird aufgezeigt, wie man das Blockieren des \"plugin_load\" Befehls bei Half-Life 2 basierenden Servern wie Counter-Strike: Source aushebeln kann. Die Methode ist denkbar simpel und geht auch bei den Linux *.so Binarys.</p>\n<p>Der Autor verschweigt aber eine wesentliche Sache. Bei den allermeisten protected Systemen wird der Server unter einem separatem User erstellt, bei dem man bestenfalls Leserechte bei den *.so Dateien hat. Es ist in diesem Fall nicht möglich, eine modifizierte engine.so hochzuladen.</p>\n<p>In einem anderen Zusammenhang könnte man damit aber Schaden anrichten. Man denke einmal an Slots, SourceTV und dergleichen, deren Einstellungen vom Benutzer eigentlich nicht änderbar sein sollen. Es ist deswegen eine Überlegung Wert, die *.so Dateien in den bin/ Ordnern gesondert vor dem Benutzerzugriff zu schützen.</p>\n<p>Man muss wohl nicht extra erwähnen, dass das Vornehmen dieser Modifikation auf einem Fremdsystem sehr wahrscheinlich eine Straftat ist. Falls man die Methode nachvollziehen möchte, dann bitte nur auf einem eignen Rootserver, oder lokalem Testsystem.</p>","id":"8bbd04cd-20e8-5dea-afa1-db7a3fed2d6b","frontmatter":{"title":"SSH protected Bypass, oder doch nicht?","date":"2011-11-07","tags":["steam","game-server","security"]},"fields":{"slug":"/ssh-protected-bypass-oder-doch-nicht/"},"timeToRead":1}},{"node":{"excerpt":"dass man mit Gamserver Plugins mehr anstellen kann, als nur Admin Verwaltung und Spielmodifikationen? In letzter Zeit habe ich viel darüber geschrieben, welche Maßnahmen man ergreifen sollte, um den…","html":"<p>dass man mit Gamserver Plugins mehr anstellen kann, als nur Admin Verwaltung und Spielmodifikationen?</p>\n<p>In letzter Zeit habe ich viel darüber geschrieben, welche Maßnahmen man ergreifen sollte, um den Zugriff aus Gameserver Installationen abzusichern. Je nach Hostinglösung wird bereits einiges im Vorfeld verhindert und oder die Folgen von erfolgreich durchgeführten kleineren Exploits beseitigt.</p>\n<p>Bei den Valve Servern der HL1 und HL2 Serie ist es möglich, eigene Plugins zu kompilieren und die .so Dateien vom Gameserver ausführen zu lassen.<br>\nDiese Möglichkeit wird gegeben, damit die Community Erweiterungen und Modifikationen zu dem jeweiligen Spiel schreiben kann. Von dieser Möglichkeit wird auch rege Gebrauch gemacht, schaut man sich die Vielzahl von Erweiterungen, wie z.B. Sourcemod, Eventscripts und deren Plugins an. Diese Art der Nutzung war und ist wohl auch Valves Intention.</p>\n<p>Anders genutzt, kann diese Freiheit den Gameserver zum größten Sicherheitsproblem von allen machen. Man kann sich z.B. etwas schreiben, dass den Shellzugriff über Rcon erlaubt. So lange es möglich ist, Plugins hochzuladen, besteht demnach immer ein Riskio.<br>\nIst dieser Schritt erst einmal gemacht, kann man mit dem Shellzugang sehr viel Schaden anrichten. Aus diesem gutem Grund wird in der Regel Gameserverkunden ja auch kein Shellzugriff eingeräumt.</p>\n<p>Dass solche Handlungen auf einem fremden System strafbar sind, sollte wohl jedem klar sein.</p>\n<p>Man sollte als Hoster deshalb darauf achten, dass Kunden, nicht per Shell in die Verzeichnisse schauen können, die sie nichts angehen. Ebenso sollte es Pflicht sein, sein System aktuell zu halten, um weniger Angriffsfläche für weitergehende Exploits zu bieten.</p>","id":"d7dd59ac-1829-563c-861a-cba6ff798b58","frontmatter":{"title":"Schon einmal daran gedacht, &#8230;","date":"2011-10-01","tags":["steam","game-server","security"]},"fields":{"slug":"/schon-einmal-daran-gedacht/"},"timeToRead":1}},{"node":{"excerpt":"Nachdem ich wieder mal eine potenzielle Schwäche mancher Hostinglösungen aufgezeigt habe, habe ich verschiedene Reaktionen erhalten. Zu den Lücken sei noch gesagt, dass alle bisher beschriebenen…","html":"<p>Nachdem ich wieder mal eine potenzielle Schwäche mancher Hostinglösungen aufgezeigt habe, habe ich verschiedene Reaktionen erhalten. Zu den Lücken sei noch gesagt, dass alle bisher beschriebenen altbekannt sind und schon lange vor meinen Artikel ausgenutzt wurden.</p>\n<p>Goas von g-portal hat mich zum Beispiel eingeladen, mal zu testen, ob ich durch deren Schutz komme. Was mir mit meinen derzeitigen Möglichkeiten nicht gelungen ist.<br>\nEine solche Lösung ist bei großen Firmen eigentlich Gang und Gebe. Die wirklich großen Unternehmen wie Facebook und Microsoft haben sogar Belohnungen für diejenigen ausgelobt, die Fehler und Schwachstellen der Angebotenen Software melden.</p>\n<p>Ob nun für gefundene Sicherheitslücken gezahlt wird, oder nicht, eines haben solche Unternehmen gemein. Sie sind stets darum bemüht, ihr Produkt zu verbessern.</p>\n<p>Andere Mails gingen leider in eine ganz andere Richtung. Relativ am Anfang heißt es in einer gleich sinngemäß, dass man sich nicht unnötig mit Abmahnungen streiten muss, wie der Schreibende es bereits mit einer anderen Person macht.</p>\n<p>Ich habe diese Aussage, als haltlose Drohung aufgefasst und mit einer kleinen Ausführung zur Pressefreiheit geantwortet. Ich kann ja verstehen, dass man keine negative Presse möchte. Hätte man ohne Drohung freundlich gefragt, hätte ich ebenso freundlich reagiert.</p>\n<p>Im weiteren Verlauf wurde erst behauptet, man sei sicher und erfülle alle Voraussetzungen. Dann hieß es, die ESL sei an alledem Schuld, weil sie ihnen nicht nachtragen, wie man das eigene System einzurichten habe. Man konnte sich also nicht entscheiden, ob man denn sicher sei, oder ob für alle Lücken im eigenen System alleinig die anderen schuld sind.</p>\n<p>Die zweite Art von Reaktion kann man also in das Schema drohen und dann aus den Augen aus dem Sinn beschreiben. Man kann für die Kunden solcher Unternehmen nur hoffen, dass sie ebenso viel Energie mit Fehlerbehebung aufwenden, wie beim Versuch, Zensur auszuüben.</p>\n<p>Ich habe mich dennoch entschlossen die entsprechenden Namen und Textpassagen abzuändern und zu löschen, soweit der Sinn der Texte erhalten geblieben ist. Dies mache ich aus einem einfachen Grund. Ich habe auf solche Sandkastenstreits keine Lust. Jedem der sich einmal mit der Pressefreiheit auseinandergesetzt hat, der weiß, dass ich Tatsachen jederzeit nennen darf. Dass auch Blogs der Pressefreiheit unterliegen, wurde schon bei Streitigkeiten der Deutsche Bahn und des DFB festgestellt.</p>\n<p>Ich biete zwar auch eigenes Webinterface an. Damit man die Artikel nicht als vergleichende Werbung auffassen kann, habe ich es unterlassen, meine Software in Artikeln, in denen auch die Konkurrenz genannt wird, zu erwähnen.<br>\nSelbst wenn man die Artikel sehr großzügig als vergleichende Werbung ansehen würde, ist diese grundsätzlich zulässig. So darf man mit jedermann zugänglichen Tatsachen vergleichen. Mit Tatsachen sind dabei wohl Dinge wie die ADAC Pannenstatistik gemeint.</p>","id":"59b02a0a-db8d-5fc9-ba1b-4bf3b361ab46","frontmatter":{"title":"Über den Umgang von Firmen mit Sicherheitslücken","date":"2011-09-22","tags":["security","ESL"]},"fields":{"slug":"/uber-den-umgang-von-firmen-mit-sicherheitslucken/"},"timeToRead":2}},{"node":{"excerpt":"Ich bin bereits in vorherigen Artikeln darauf eingegangen, wie man mittels FTP Client und dem Servercommand plugin_load bei vielen Hostern den so genannten Protection Modus aushebeln kann: Cheat…","html":"<p>Ich bin bereits in vorherigen Artikeln darauf eingegangen, wie man mittels FTP Client und dem Servercommand <strong>plugin_load</strong> bei vielen Hostern den so genannten Protection Modus aushebeln kann:</p>\n<ul>\n<li><a href=\"/cheat-protected-server-oder-doch-nicht/\">Cheat Protected Server, oder doch nicht?</a></li>\n<li><a href=\"/cheat-protected-server-nr-2/\">Cheat protected Server Nr.2</a></li>\n<li><a href=\"/cheat-protected-server-nr-3/\">Cheat protected Server Nr.3</a></li>\n</ul>\n<p>Eine wesentlich schlimmere Lücke, die entsteht, wenn der Hoster seinen FTP Client nicht anständig konfiguriert, bzw. System durchdenkt, hatte ich etwas später beschrieben. Mittels FTP Client und einem einfachen Editor ist es damit möglich, beliebigen Shellcode bei dem Hoster auszuführen. Dass ein solchen Server nicht Servercheat sicher ist, sollte klar sein.<br>\nDer Artikel findet sich hier:</p>\n<ul>\n<li><a href=\"/gameserverhoster-machen-das-hacken-sehr-einfach/\">Gameserverhoster machen das Hacken sehr einfach</a></li>\n</ul>\n<p>In allen Artikeln gebe ich gleich Hinweise, wie man ein Ausnutzen der Schwächen verhindern kann. In der Regel handelt es sich um LIMIT Anweisungen für den FTP Server, die den Zugriff auf bestimmte Dateien per FTP verhindern.</p>\n<p>Es gibt aber noch andere Wege, als einen FTP Client, um die Serverskripte zu manipulieren, den ich bisher nicht beschrieben habe. Das Einfallstor ist dabei der Gameserver selber. Genauer sind es die Möglichkeiten, die man mit Servertools und Plugins bei der Orangebox Engine hat. In den Beispielen wird die Sprache Sourcepawn benutzt, in der man Sourcemodplugins schreibt.</p>\n<p>Bevor versucht wird, das beschriebene nachzumachen sollte man sich eines bewusst machen:<br>\nAlle Lücken sollten nur auf eigenen Roootservern getestet werden. Indem Moment, indem man Kunde bei einem Gameserverhoster ist, ist ein Eingriff in dessen Datenverarbeitung sicherlich strafbar.</p>\n<p>Im ersten Schritt ermittle ich den Inhalt des Binary und Skript Ordners, um festzustellen, ob der Hoster auf das srcds_run Startskript zurück gereift, oder eine eigene Lösung verwendet. Dies kann man mit einem FTP Client machen, oder einem Plugin. Mein Soucemod Plugincode ist sehr rudimentär, erfüllt aber seinen Zweck:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-c line-numbers\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">PLUGIN_VERSION</span> <span class=\"token string\">\"0.1\"</span></span>\npublic Plugin<span class=\"token operator\">:</span>myinfo <span class=\"token operator\">=</span> \n<span class=\"token punctuation\">{</span>\n name <span class=\"token operator\">=</span> <span class=\"token string\">\"runscripts and binaries check\"</span><span class=\"token punctuation\">,</span>\n author <span class=\"token operator\">=</span> <span class=\"token string\">\"Terrorkarotte\"</span><span class=\"token punctuation\">,</span>\n description <span class=\"token operator\">=</span> <span class=\"token string\">\"POC for testing protection mode and server security\"</span><span class=\"token punctuation\">,</span>\n version <span class=\"token operator\">=</span> PLUGIN_VERSION<span class=\"token punctuation\">,</span>\n url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://ulrich-block.de\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\npublic <span class=\"token function\">OnPluginStart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n new String<span class=\"token operator\">:</span>path<span class=\"token punctuation\">[</span>PLATFORM_MAX_PATH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n new Handle<span class=\"token operator\">:</span>dir <span class=\"token operator\">=</span> <span class=\"token function\">OpenDirectory</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dir <span class=\"token operator\">==</span> INVALID_HANDLE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">PrintToServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cant go to 'orangebox/'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> false<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">PrintToServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I am in 'orangebox/'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">ReadDirEntry</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token function\">PrintToServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n <span class=\"token keyword\">return</span> true<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nachdem man weiß, welche Datei überschrieben werden muss, lädt man eine bereits modifizierte Datei per FTP hoch. Dabei kann man z.B. die Dateiendung .bsp verwenden und sie in das maps/ Verzeichnis packen, obwohl es sich um ein Skript handelt. Auf diese Weise kann man zuverlässig jegliche FTP Filter umgehen. Wenn man nun ein zusätzliches Plugin hat, dass Dateien verschieben und Chmods setzen kann, dann kann man dem Interface jetzt seinen eigenen Code unterschummeln.</p>\n<p>Wenn das Webinterface nun nicht aufpasst, was es da so alles startet, dann wird der eingeschleuste Code ausgeführt und man kann allerlei anrichten. Man könnte z.B. eine Funktion vom Screen des laufenden Gameservers abkoppeln, die dann alle X Sekunden prüft, ob der Gameserver noch läuft und wenn nein den Server aus dem ungeschützten Verzeichnis neu startet. Wenn dies schnell genug geschieht, dann ist der Gameserverport bereits belegt, wenn der protected Gameserver gestartet wird. Der protected Gameserver nimmt sich dann den nächst höheren Port und das Webinterface denkt, dass alles in Ordnung ist. Des Weiteren könnte man sich auch seinen eigenen SSH2 Deamon bauen, um direkt auf der Shell zu arbeiten. Dies geht z.B. relativ einfach mit Tools wie netcat und telnet.</p>\n<p>Hier noch ein bisschen Pseudocode, der veranschaulichen sollte, was ich meine. Dass ich keine 1:1 Anleitung gebe, ist denke ich mal verständlich.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\n<span class=\"token function-name function\">backgroundfunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">while</span> immer war<span class=\"token punctuation\">;</span> mach\n  schlafe x sekunden\n  wenn server nicht läuft<span class=\"token punctuation\">;</span> dann\n   starte aus dem unprotected Verzeichnis\n  <span class=\"token keyword\">fi</span>\n <span class=\"token keyword\">done</span>\n<span class=\"token punctuation\">}</span>\n\nbackgroundfunction<span class=\"token operator\">&amp;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"5e9516c2-3cf6-559c-96d0-74e4b064caac","frontmatter":{"title":"Cheat protected Server? Ich denke nicht!","date":"2011-09-20","tags":["security","game-server"]},"fields":{"slug":"/cheat-protected-server-nr-4/"},"timeToRead":3}},{"node":{"excerpt":"Ich wurde gebeten, mein Webinterface easy-wi um eine Möglichkeit zu erweitern, den Serverstatus extern erfragen zu können. Dies insbesondere im Hinblick auf den Protection Modus. Das Ganze habe ich…","html":"<p>Ich wurde gebeten, mein Webinterface <a href=\"https://easy-wi.com\" target=\"_blank\" rel=\"external noopener noreferrer\">easy-wi</a> um eine Möglichkeit zu erweitern, den Serverstatus extern erfragen zu können. Dies insbesondere im Hinblick auf den Protection Modus.</p>\n<p>Das Ganze habe ich mit XML realisiert. Wie die Ausgabe aussieht, kann man hier sehen: <a href=\"http://demo.easy-wi.com/protectioncheck.php?ip=11.11.11.11&#x26;po=27015&#x26;gamestring=xml\" target=\"_blank\" rel=\"external noopener noreferrer\">http://demo.easy-wi.com/protectioncheck.php?ip=11.11.11.11&#x26;po=27015&#x26;gamestring=xml</a></p>\n<p>Dabei kam mir die Idee, die ESL darauf hinzuweisen, dass man einführen könnte, dass alle Anbieter eine vergleichbare Schnittstelle bieten und die Spieler den Status zentral bei der ESL anfragen können.</p>\n<p>Da der Protection Modus bei unterschiedlichen Spielen wie z.B. Counter-Strike 1.6, Counter-Strike: Source und Call of Duty, die allesamt unterschiedliche Engines verwenden zum Einsatz kommt, entschloss ich mich, <a href=\"http://www.esl.eu/de/forum/5/16/964725/\" target=\"_blank\" rel=\"external noopener noreferrer\">diesen Vorschlag im allgemeinen Feedback Forum zu stellen</a>.</p>\n<p>Wenn ich den Beitrag in einem falschen geschrieben habe, dann wäre es für einen Admin ein Leichtes gewesen, den Beitrag zu verschieben. Statt dessen entschied man sich eine pampige Antwort zu schreiben und das Thema zu schließen.</p>\n<p>Anscheinend liegt der ESL ihr Modus nicht besonders am Herzen.</p>","id":"a7ee8dae-0ba3-5e26-a31d-3c3d458a02da","frontmatter":{"title":"Protected Modus für die ESL","date":"2011-09-04","tags":["security","game-server","ESL"]},"fields":{"slug":"/protected-modus-fur-die-esl/"},"timeToRead":1}},{"node":{"excerpt":"Vor einigen Monaten hat die ESL ein Serverplugin eingeführt. Vorgeblich sollte es das Administrieren des Warservers vereinfachen und noch einige andere Funktionen mit sich bringen. Eine nicht…","html":"<p>Vor einigen Monaten hat die ESL ein <a href=\"http://www.esl.eu/de/css/plugin\" target=\"_blank\" rel=\"external noopener noreferrer\">Serverplugin</a> eingeführt. Vorgeblich sollte es das Administrieren des Warservers vereinfachen und noch einige andere Funktionen mit sich bringen.</p>\n<p><a href=\"http://www.sourcejunkies.de/forum/thread/4535/page/10/#post_232\" target=\"_blank\" rel=\"external noopener noreferrer\">Eine nicht dokumentiert Funktion wurde nun im Rahmen der Vergabe von Strafpunkten bekannt</a>:<br>\n<strong>Das Plugin ist in der Lage Rcon Passwörter auszuspionieren</strong>!</p>\n<p>Diese Funkion wurde auch aktiv genutzt, um Personen, die einen Cheat auf Gameservern installiert hatten, zu überführen.</p>\n<p>Dies ist natürlich ohne das Wissen der Serverbetreiber und wahrscheinlich auch ohne Wissen der Hoster geschehen.</p>\n<p>Die Absicht, Betrüger in Ligaspielen zu überführen ist sicherlich gut gemeint. Man hätte sich aber auch einmal mit den rechtlichen Aspekten befassen sollen. Bei der Idee, bewusst zu verheimlichen, dass das Plugin dazu genutzt werden kann, Zugangsdaten auszuspionieren, müssen eigentlich alle Alarmglocken schrillen. Insbesondere im Hinblick auf die damals so hitzig geführte Diskussion über den so genannten <a href=\"http://de.wikipedia.org/wiki/Hackerparagraf\" target=\"_blank\" rel=\"external noopener noreferrer\">Hackerparagraphen</a>.</p>\n<p><a href=\"http://dejure.org/gesetze/StGB/202a.html\" target=\"_blank\" rel=\"external noopener noreferrer\">§202a StGB</a> (Ausspähen von Daten) sagt:</p>\n<blockquote>\n<p>(1) Wer unbefugt sich oder einem anderen Zugang zu Daten, die nicht für ihn bestimmt und die gegen unberechtigten Zugang besonders gesichert sind, unter Überwindung der Zugangssicherung verschafft, wird mit Freiheitsstrafe bis zu drei Jahren oder mit Geldstrafe bestraft.<br>\n(2) Daten im Sinne des Absatzes 1 sind nur solche, die elektronisch, magnetisch oder sonst nicht unmittelbar wahrnehmbar gespeichert sind oder übermittelt werden.</p>\n</blockquote>\n<p>Darüber hinaus heißt es in <a href=\"http://dejure.org/gesetze/StGB/202c.html\" target=\"_blank\" rel=\"external noopener noreferrer\">§202c StGB</a> (Vorbereiten des Ausspähens und Abfangens von Daten):</p>\n<blockquote>\n<p>(1) Wer eine Straftat nach § 202a oder § 202b vorbereitet, indem er<br>\n(…)<br>\n2. Computerprogramme, deren Zweck die Begehung einer solchen Tat ist,<br>\nherstellt, sich oder einem anderen verschafft, verkauft, einem anderen überlässt, verbreitet oder sonst zugänglich macht, wird mit Freiheitsstrafe bis zu einem Jahr oder mit Geldstrafe bestraft.<br>\n(…)</p>\n</blockquote>\n<p>Ausnahmsweise ist das Gesetz sehr eindeutig. Wenn die Verantwortlichen Pech haben, hagelt es nun Anzeigen. Wenn sie noch mehr Pech haben, wird nicht wegen Geringfügigkeit eingestellt und sie vor Gericht angeklagt.</p>\n<p>Lange juristische Texte liest sich ja kaum einer durch, so dass die allermeisten einfach auf ja, ok, weiter, oder \"lass mich endlich installieren\" klicken. Hätte man das Ausspähen in AGB bzw. ANB geregelt, hätte man sicherlich auch genügend Leute erwischt und würde sich jetzt nicht in einer solch angreifbaren Position befinden.</p>","id":"5e0ce931-3113-5922-93b7-0271956cbc8e","frontmatter":{"title":"Es war ja nur gut gemeint","date":"2011-08-30","tags":["steam","game-server","security","ESL"]},"fields":{"slug":"/es-war-ja-nur-gut-gemeint/"},"timeToRead":2}},{"node":{"excerpt":"Ich bin gerade auf ein Firefox Plugin aufmerksam geworden, dass mir sehr sinnvoll erscheint. Es nennt sich RequestPolicy. Die Webseite zu dem Plugin ist hier zu finden. Es kommt sehr oft vor, dass…","html":"<p>Ich bin gerade auf ein Firefox Plugin aufmerksam geworden, dass mir sehr sinnvoll erscheint. Es nennt sich RequestPolicy. <a href=\"https://www.requestpolicy.com/\" target=\"_blank\" rel=\"external noopener noreferrer\">Die Webseite zu dem Plugin ist hier zu finden.</a></p>\n<p>Es kommt sehr oft vor, dass Webseiten Elemente von anderen Diensten einbinden. Sei es der Facebook Like Button, oder etwas wirklich schädliches. Dabei kommt es sehr oft vor, dass Benutzerdaten ungefragt weitergegeben, Cookies installiert und andere nicht ganz so freundliche Dinge vorgenommen werden.</p>\n<p>RequestPolicy blockiert alles, was von anderen Domains kommt, als die man aufgerufen hat, es sei denn, man erlaubt den Aufruf.<br>\nMan kann mit diesem Plugin also seine Privatsphäre schützen und verhindern, dass externer Code ungewollte aufgerufen wird.</p>\n<p>Zusätzlich benutze ich schon seit längerem das Plugin <a href=\"https://addons.mozilla.org/de/firefox/addon/cookie-monster/\" target=\"_blank\" rel=\"external noopener noreferrer\">Cookie Monster</a>. Dabei verweigere ich grundsätzlich die Annahme von Cookies und erlaube über das Plugin dann die Ausnahmen.</p>","id":"c4e06e70-4648-50db-8b85-b48e56e15424","frontmatter":{"title":"Etwas mehr Sicherheit und Privatsphäre","date":"2011-08-19","tags":["Firefox","security"]},"fields":{"slug":"/etwas-mehr-sicherheit-und-privatsphaere/"},"timeToRead":1}},{"node":{"excerpt":"Ich habe noch einen kleinen Nachtrag zu dem Umgehen des Protection Modus. Wie man ihn leicht umgehen kann, hatte ich in diesem Beitrag beschrieben. Das man dieses Vorgehen durch das setzen eines…","html":"<p>Ich habe noch einen kleinen Nachtrag zu dem Umgehen des Protection Modus.<br>\nWie man ihn leicht umgehen kann, hatte ich in <a href=\"/cheat-protected-server-oder-doch-nicht/\">diesem Beitrag</a> beschrieben.</p>\n<p>Das man dieses Vorgehen durch das setzen eines Aliases verhindern kann hatte ich <a href=\"/cheat-protected-server-nr-2/\">dann hier nachgetragen</a>.</p>\n<p>Ich hätte vielleicht noch erwähnen sollen, wo man diesen Eintrag vornehmen und was man zusätzlich absichern muss. Wichtig ist zu wissen, welche und in welcher Reihenfolge Parameter beim Start geladen werden<br>\nDer Ablauf wird in der Datei valve.rc festgelegt, die sich im Verzeichnis CFG befindet. Standardmäßig sieht deren Inhalt so aus:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// load the base configuration\n//exec default.cfg\nr_decal_cullsize 1\n\n// Setup custom controller\nexec joystick.cfg\n\n// run a user script file if present\nexec autoexec.cfg\n\n//\n// stuff command line statements\n//\nstuffcmds</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Der Befehl \"stuffcmds\" sind die Startparameter, die in der Konsole angegeben werden. Diese werden, wie man sieht, erst nach 2 Configs geladen. Ebenso kann der User das Laden der Parameter beeinflussen, wenn er Zugriff auf die valve.rc bekommt. Er kann also den Befehl plugin_load in die valve.rc, oder in die Configs schreiben, die vor den Stuffcmds geladen werden und so den Alias aus dem Startbefehl aushebeln.</p>\n<p>Damit der User dazu keine Chance hat, sollten der, oder die Aliase an erster Stelle in der valve.rc stehen. Darüber hinaus darf der User die valve.rc nicht editieren können.<br>\nMit dem Proftpd könnte man dies so lösen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;Directory ~>\nHideFiles (^\\..+|\\.ssh|srcds_run$|srcds_linux$|valve.rc$|\\.sh$)\nPathDenyFilter (.+?/\\..+|srcds_run$|srcds_linux$|valve.rc|\\.sh$)\nHideNoAccess on\n&lt;/Directory></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Der Filter blockiert darüber hinaus noch den Zugriff auf die srcds_* und *.sh Dateien.</p>","id":"360db7c5-5585-5d02-89d4-4389d03c3d4e","frontmatter":{"title":"Cheat protected Server Nr.3","date":"2011-02-27","tags":["game-server","security"]},"fields":{"slug":"/cheat-protected-server-nr-3/"},"timeToRead":1}},{"node":{"excerpt":"Ich hatte in einem früheren Beitrag geschildert, wie man recht einfach die bestehenden protection Systeme aushebeln kann. Im Gegensatz zum Nachladen von Plugins, gibt es noch wesentlich…","html":"<p>Ich hatte in einem früheren <a href=\"/cheat-protected-server-oder-doch-nicht/\">Beitrag</a> geschildert, wie man recht einfach die bestehenden protection Systeme aushebeln kann.</p>\n<p>Im Gegensatz zum Nachladen von Plugins, gibt es noch wesentlich schwerwiegendere Probleme, wenn der Hoster, keine Absicherung seines FTP Servers vornimmt. Ich habe einige Interfaceanbieter auf dieses Problem hingewiesen. Wenn diese es an ihre Kunden weitergeleitet haben, sollte es hoffentlich nicht mehr so viele Hoster betreffen.</p>\n<p>Auf vielen Systemen sind die CHMODs nicht ausreichend streng gesetzt, so dass man sehr einfach auf viele Dateien des Systems zugreifen kann. Dies liegt sehr oft daran, dass die Umasks nicht ausreichend streng gewählt wurden.</p>\n<p>Viele Programme und Serverdienste, wie auch der Counter-Strike Source Server, setzen Startskripte ein, die in der Programmiersprache Bash geschrieben sind. Sind die Rechte auf dem System nun zu lasch gewählt, kann man mit einem Editor diese Dateien bearbeiten und in die Skripte zusätzlichen Code schreiben, welcher bei einem Start des Servers ausgeführt wird. Startskripte der (Game)server sind z.B. (hlds_run|srcds_run|…). Alternativ kann man das Skript, oder die (srcds_*|hlds_*) durch eigene Dateien und Skripte austauschen. So lange sie ausführbar sind, wird bei vielen Hostern der veränderte Code einfach ausgeführt.<br>\nDie Skripte ohne Erlaubnis zu verändern ist sehr wahrscheinlich strafbar. Für genauere Informationen fragt den Anwalt eures Vertrauens.</p>\n<p>Die harmloseste Variante beim Verändern wäre es, die Startparameter des Hosters zu überschreiben um den eigenen Server aufzuwerten. Es geht aber auch wesentlich schlimmer.</p>\n<p>Mit etwas Ahnung kann man auf diese Weise das Hostsystem nach Belieben analysieren und ausspionieren. Bei Bekannten habe ich auf diese Weise sehr schnell von einem Gameserver ausgehend deren MYSQL Zugangsdaten der Webseiten gehabt, als ich den Server auf Sicherheit testen sollte. Durch die Mehrfachverwendung von Passwörtern hatte ich dann auch noch Zugriff auf Master- und Rootaccounts. Durch geschickte Analyse kann man sich also sehr schnell durch die Accounts und Daten des Systems arbeiten und weitgehende Recht erlangen.</p>\n<p>Man kann natürlich auch den Server dazu veranlassen andere Programme und Dienste auszuführen, als eigentlich vom Hoster gewollt. Dies stellt gerade deswegen eine große Gefahr dar, weil es unzählige Exploits bei verschiedensten Paketen und Kerneln gibt, mit denen man schnell Rootrechte erlangen kann.</p>\n<p>Es handelt sich also um ein extrem schwerwiegendes Sicherheitsproblem, von dem wohl Anbieter Anbieter betroffen sein könnte.<br>\nMan kann nun der Ansicht sein, dass es nicht weiter relevant ist, weil ja bekannt ist, wer den Server angemietet hat und diesen so haftbar für eventuelle Schäden machen kann.</p>\n<p>Doch was ist mit Fakebestellungen, abhanden gekommenen Passwörtern, Testaccounts usw.? Außerdem kann sich jeder auf den Punkt stellen, hinter der eingeloggten IP steckte ich nicht, es hatten X andere Menschen über diese Anschluss Zugriff auf das Internet.</p>\n<p>Letztendlich muss dem Täter bewiesen werden, dass er es war. Dies wird mehr als problematisch werden und sehr wahrscheinlich zu nichts führen.</p>\n<p>Auch wird sich, wenn irgendwo ein Schaden durch den Root entstanden ist, erst einmal an den Rooteigentümer gewendet.</p>\n<p>Ich könnte mir vorstellen, dass die Rechtspechung hier auch die Störerhaftung anwendet, weil der Rooteigentümer bzw. Mieter den Server fahrlässiger Weise nicht ausreichend abgesichert hat. Diese rechtlichen Fragen sollten aber besser von einem Anwalt beantwortet werden.</p>\n<p>Der Schluss aus dem Gesagten muss also sein, dass man diese Dateien nicht mehr ändern kann und die einzelnen User auf der Shell weniger zu sehen bekommen.</p>\n<p>Ein erster Ansatz ist es die Umasks vom System selber strenger einzustellen:</p>\n<p>In der Datei \"/etc/profile\" sollte die Umask so aussehen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">umask 077</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>In der \"/etc/adduser.conf\":</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">DIR_MODE=0700</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nachdem man die Umasks eingestellt hat, sollte man sein System überprüfen und ggf. die Chmods strenger einstellen.</p>\n<p>Auf diese Weise kann User A dann weniger von User B erfahren.</p>\n<p>Es bleibt das Problem, dass der User auf seine eigenen Startskripte zugreifen kann. Hier gibt es nun verschiedene Lösungsansätze.</p>\n<p>Eine wäre es, das immutable Bit zu setzen. Damit nimmt man sich aber die Möglichkeit diese Dateien von Autoupdatern aktualisieren zu lassen. Hat man nun viele Server im System werden Updates sehr aufwendig, so dass diese Methode wenig gangbar ist.</p>\n<p>Die Datei einem anderen User zuzuordnen und einen Strengen Chmod zu verwenden führt zu der selben Problematik.</p>\n<p>Etwas gangbarer ist es, eine aktuelle Serverinstallation auf dem Rootserver zu haben und bei jedem Serverstart die kritischen Dateien mit Dateien aus dieser Installation zu überschreiben.</p>\n<p>Zusätzlich zum Überschreiben, sperre ich die Dateien beim FTP Server selber bzw. blockiere den Zugriff.</p>\n<p>Der FTPServer ProFTPD ermöglicht eine sehr umfassende Konfiguration und Limitierung.</p>\n<p>Auch beim FTPServer stelle ich eine strenge Standardumask ein:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Umask 077  077</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Man kann kann z.B. FTP Befehle für bestimmte Ordner und Unterordner sperren und dann nur für bestimmte Unterordner wieder erlauben. Ich blocke auch die Möglichkeit die CHMODs per FTP zu ändern:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># Erstmal alles verbieten\n&lt;Directory ~/*>\n    &lt;Limit RNTO RNFR STOR DELE DIRS CHMOD>\n        DenyAll\n    &lt;/Limit>\n&lt;/Directory>\n\n# Die Sperre fuer das Modverzeichnis bei orangebox Spielen aufheben\n# das erste * hinter orangebox/ ist eine Wildcard, erfasst also sämtliche\n# Bezeichnungen wie tf, cstrike, dods, usw.\n&lt;Directory ~/server/*/orangebox/*/*>\n    &lt;Limit RNFR RNTO STOR DELE>\n        AllowAll\n    &lt;/Limit>\n&lt;/Directory>\n\n# Die Sperre fuer das Modverzeichnis bei cstrike aufheben\n&lt;Directory ~/server/*/cstrike/*>\n    &lt;Limit RNFR RNTO STOR DELE>\n        AllowAll\n    &lt;/Limit>\n&lt;/Directory>\n\n# Die Sperre fuer das Modverzeichnis bei dod aufheben\n&lt;Directory ~/server/*/dod/*>\n    &lt;Limit RNFR RNTO STOR DELE>\n        AllowAll\n    &lt;/Limit>\n&lt;/Directory>\n\n# Die Sperre fuer das Modverzeichnis bei czero aufheben\n&lt;Directory ~/server/*/czero/*>\n    &lt;Limit RNFR RNTO STOR DELE>\n        AllowAll\n    &lt;/Limit>\n&lt;/Directory></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Zusätzlich, oder alternativ kann man den Zugriff auf bestimmte Dateien, oder Dateitypen komplett blockieren. Dead_Eye von <a href=\"http://sourceserver.info\" target=\"_blank\" rel=\"external noopener noreferrer\">sourceserver.info</a> hat z.B. folgende Regeln geschrieben:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;Directory ~>\n    HideFiles (^\\..+|\\.ssh|srcds_run$|srcds_linux$|valve.rc$|\\.sh$)\n    PathDenyFilter (.+?/\\..+|srcds_run$|srcds_linux$|valve.rc|\\.sh$)\n    HideNoAccess on\n&lt;/Directory></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"332f4ed8-f46c-518d-b23b-fbf3acf09346","frontmatter":{"title":"Gameserverhoster machen das Hacken sehr einfach","date":"2011-02-24","tags":["game-server","security"]},"fields":{"slug":"/gameserverhoster-machen-das-hacken-sehr-einfach/"},"timeToRead":4}},{"node":{"excerpt":"In meinem Beitrag Cheat Protected Server, oder doch nicht? hatte ich eine Möglichkeit aufgezeigt, mit der sich die meisten gängigen Protection Systeme von Gameserver Anbietern aushebeln kann…","html":"<p>In meinem Beitrag <a href=\"/cheat-protected-server-oder-doch-nicht/\">Cheat Protected Server, oder doch nicht?</a> hatte ich eine Möglichkeit aufgezeigt, mit der sich die meisten gängigen Protection Systeme von Gameserver Anbietern aushebeln kann.</p>\n<p>Mittlerweile haben manche Kunden, deren Anbieter nicht von mir getestete Software einsetzen, bestätigt, dass es bei ihnen auch geht.</p>\n<p>DeaD_Eye von <a href=\"http://sourceserver.info\" target=\"_blank\" rel=\"external noopener noreferrer\">sourceserver.info</a> hat mir den Hinweis gegeben, dass man mit einem zusätzlichen Startparameter zumindestens bei HL2 Spielen verhindern kann, dass Plugins nachgeladen werden können.<br>\nMan belegt einfach den Servercommand \"plugin_load\" neu:<br>\n<code class=\"language-text\">+alias \"plugin_load\"</code><br>\nAfaik ist dies irreversibel. Man kann den Alias zwar nochmals neu belegen, die eigentliche Funktion des Commands sollte sich aber nicht wieder herstellen lassen.</p>\n<p>Man kann der Ansicht sein, dass es falsch ist die Informationen in einem Blog zu veröffentlichen, weil dann jeder noch so unbegabte diese Informationen zum Cheaten benutzen kann.</p>\n<p>Hätte ich die Lücke selber entdeckt und wäre sie unbekannt gewesen, hätte ich sicherlich den Anbietern eine Vorlaufzeit gegeben, nachdem ich sie informiert hätte. Und erst nach einer Frist den Artikel veröffentlicht.<br>\nDie Vorgehensweise ist jedoch schon länger bekannt und auf den Mailinglisten diskutiert worden. Zum Teil wurde sie auch in relevanten Foren, bzw. Anbieter direkt darauf angesprochen.<br>\nWem die Methode unbekannt war, hat es unterlassen die Neuigkeiten und Nachrichten zu der von ihm eingesetzten Software zu verfolgen, oder das Problem ignoriert.</p>\n<p>Wenn man jetzt damit wirbt, dass seine Server, bzw. sein Produkt sicher seien, es aber unterlässt, die notwendige Sorgfalt an den Tag zu legen, sehe ich es nicht ein, Rücksicht zu nehmen.</p>\n<p>Es gab sicherlich den ein oder anderen, der sich über die Veröffentlichung nicht gerade gefreut hat. Manch einer mag sie vielleicht auch als Frechheit bezeichnen, weil man in ein schlechtes Licht gerückt wird.<br>\nAnstelle gegen denjenigen zu ätzen, der die Probleme beim Namen nennt, sollte man sich lieber an die eigene Nase fassen, warum man die Schwachstellen und die Stimmen, die gewarnt haben, ignoriert, oder übersehen hat. Dazu sollte man die Probleme natürlich auch beheben.</p>","id":"dc8164ae-820a-5286-b458-1191b7568794","frontmatter":{"title":"Cheat protected Server Nr.2","date":"2011-02-19","tags":["game-server","security"]},"fields":{"slug":"/cheat-protected-server-nr-2/"},"timeToRead":1}},{"node":{"excerpt":"Ich hatte mich vor einiger Zeit darüber ausgelassen, dass das Abspeichern von Passwörtern als reiner MD5 Hash zu einem Sicherheitsproblem werden kann, wenn die Datenbank in die falschen Hände gelangt…","html":"<p><a href=\"/md5-hashes-fur-passworter-sind-unsicherer-als-man-denkt/\">Ich hatte mich vor einiger Zeit darüber ausgelassen</a>, dass das Abspeichern von Passwörtern als reiner MD5 Hash zu einem Sicherheitsproblem werden kann, wenn die Datenbank in die falschen Hände gelangt.</p>\n<p>Vor kurzem machte eine US Sicherheitsfirma Jagt auf eine Hackergruppe und wurde dann von dieser erfolgreich attackiert. Man könnte jetzt denken, dass die Gruppe schwere Geschütze aufgefahren hat, um ihr Ziel zu erreichen.<br>\nAnscheinend ist man aber durch eine einfache SQL Injection an eine Datenbank gekommen, in der Passwörter als ungesalzene MD5 Hashes abgelegt waren. Mittels Rainbow Tabellen, konnten diese Passwörter relativ einfach herausgefunden werden.<br>\nDa Hauptverantwortliche ihre Passwörter auf verschiedenen Systemen eingesetzt haben, war es dann wohl ein leichtes, den Zugriff auf andere System auszuweiten und hier abermals an Datenbanken mit ungesalzenen MD5 Passwörtern zu gelangen.</p>\n<p>Zusammenfassend kann man sagen, das ich es ziemlich schwach finde als \"Sicherheitsexperte\":</p>\n<p>– Passwörter als ungesalzenen MD5 Hash zu speichern<br>\n– Ein Passwort für alles einzusetzen<br>\n– Passwörter für SSH zu nutzen</p>\n<p>Genaueres kann man hier nachlesen:<br>\n<a href=\"http://www.heise.de/newsticker/meldung/Hintergruende-zum-Einbruch-bei-US-Sicherheitsfirma-1191238.html\" target=\"_blank\" rel=\"external noopener noreferrer\">heise.de</a><br>\n<a href=\"http://arstechnica.com/tech-policy/news/2011/02/anonymous-speaks-the-inside-story-of-the-hbgary-hack.ars/\" target=\"_blank\" rel=\"external noopener noreferrer\">arstechnica.com</a></p>","id":"ce99f8d5-d50e-5fd8-a567-831d130439b6","frontmatter":{"title":"Die größte Sicherheitslücke eines Systems ist der Mensch","date":"2011-02-17","tags":["security"]},"fields":{"slug":"/die-groste-sicherheitslucke-eines-systems-bleibt-der-mensch-selber/"},"timeToRead":1}},{"node":{"excerpt":"Die hier beschriebe Schwachstelle ist relativ einfach mittels FTP LIMIT Anweisungen von den Hostern bei sämtlichen Interface Lösungen abzustellen. Falls ein Interface Anbieter keine Regeln…","html":"<p>Die hier beschriebe Schwachstelle ist relativ einfach mittels FTP LIMIT Anweisungen von den Hostern bei sämtlichen Interface Lösungen abzustellen. Falls ein Interface Anbieter keine Regeln mitgeliefert hat, muss der Hoster seine Hausaufgaben selber machen. Es ist somit keine Schwäche eines Interfaces, sondern eine Nachlässigkeit von Hostern.<br>\nPassende Regeln werden bei meinem Webinterface <a href=\"https://easy-wi.com\" target=\"_blank\" rel=\"external noopener noreferrer\">Easy-Wi</a> bereits mitinstalliert, so dass es nicht von dieser Lücke betroffen sein. Darüber hinaus werden die fraglichen Dateien vor jedem Serverstart überschrieben, so dass auch auf andere Wege eingeschleuster Code nicht ausgeführt werden sollte.</p>\n<p>Nun zum eigentlichen Thema.</p>\n<p>Von einer großen Esport Liga angestoßen, gibt es seit einiger Zeit für Gameserver einen so genannte \"Protection Modus\". Als Grund für dessen Einführung wurde der vermehrte Einsatz von Serverseitigen Cheats angeführt. Merkmal eines solchen Servers soll es sein, dass er eben diese Cheats verhindert soll.</p>\n<p>Damit der Spieler sicher sein kann, dass dieser Modus beim Hoster auch wirklich sicher ist, wurde ein Zertifikat eingeführt. Dieses Zertifikat sagt dem Verbraucher, der \"Protection Modus\" dieses Servers dieses Hosters sind gesichert. Es ist den Hostern überlassen, wie sie dies bewerkstelligen. Die Programmierungen dahinter sind dabei recht unterschiedlich.</p>\n<p>Mitlerweile bieten die allermeisten Hoster, egal ob sie dieses Siegel besitzen, oder auch nicht, einen solchen Modus bei ihren Servern an.<br>\nDie Interfaces gehen in der Regel so vor, dass sie zum Kunden einen weiteren Benutzer im System haben. Oft wird mit diesem ein Server beim Start des protected Modus frisch installiert, manchmal auch nur ein extra Installation gesäubert. Im Regelfall hat der Kunde keinen, oder sehr eingeschränkten Zugang auf die Daten dieses Users.<br>\nDeswegen sollte man meinen, dass der Server durch diese Maßnahme sicher ist.<br>\nZumindest bei Half-Life 2 basierenden Servern ist dies aber nicht der Fall. Man muss nicht einmal Hacken bzw. Cracken, um Servertools und damit auch Cheats nachzuladen. Man braucht lediglich einen Servercommand, den jeder Half-Life 2 basierende Server kennt. Er nennt sich \"plugin_load\". Dieser Servercommand sagt dem Server, er soll ein Servertool nachladen.<br>\nBei diesem Befehl kann man absolute Pfade angeben. Bei Windows wäre absolut beginnend ab \"c:/\", bei Linux beginnt man bei \"/\".<br>\nUm den Absoluten Pfad bei Half-Life Servern zu erfahren, reicht ein Blick in die Logdateien. Wenn noch keine angelegt werden, kann man dies mit dem CVAR \"log on\" aktivieren. Gleich am Anfang werdet ihr eine Zeile finden, in der der absolute Serverpfad zu finden ist. Es ist der Eintrag in den runden Klammern hinter \"game\".</p>\n<blockquote>\n<p>L 02/13/2011 - 18:03:03: Log file started (file \"logs/L0213000.log\") (game \"/home/username/game/serverkennung/orangebox/dod\")</p>\n</blockquote>\n<p>In diesem Fall ist der absolute Pfad zum Server:<br>\n<code class=\"language-text\">/home/username/game/serverkennung/orangebox/dod</code></p>\n<p>Da nun die Ordnerstruktur bekannt ist, kann man den \"Protection Modus\" starten, wenn er nicht ohnehin schon läuft. Man lädt jetzt seine Dateien irgendwo hin.<br>\nMetamod ist zwar kein Cheat, aber es wird genau wie ein serverseitiger Cheat geladen und eigenet sich deshalb gut für die Demonstration.<br>\nBei dem Beispielserver hatte ich Metamod nach \"/home/username/game/metamod/\" hochgeladen. Man könnte die Dateien genauso gut in den \"maps\", oder \"cfg\" Ordner hochladen. Habt ihr, oder ein Bekannter, einen weiteren Server auf dem Host, kann man die Dateien auch in deren Ordner laden.<br>\nIm Anschluss lockert man noch den Chmod dieser Dateien, um sicherzustellen, dass auch wirklich jeder auf diese Dateien zugreifen kann, auf CHMOD 777.</p>\n<p>Läuft der Server, kann man die Metamod nun mit folgendem Befehl nachladen:<br>\n<code class=\"language-text\">plugin_load \"/home/username/game/metamod/binserver.so\"</code></p>\n<p>Je nachdem, in welchen Ordner man die Dateien geladen hat, muss man den Pfad anpassen.</p>\n<p>Ich habe diese Methode erfolgreich bei zwei Hostern mit deren Einverständnis erfolgreich getestet.<br>\nSehen kann man es hier:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/4f216/my.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdme5KJKBP/EABoQAQACAwEAAAAAAAAAAAAAAAEAEQIQEiL/2gAIAQEAAQUCpmV9etUKBP/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AUf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8BjX//xAAYEAADAQEAAAAAAAAAAAAAAAAAATEQQf/aAAgBAQAGPwKDO4yI/8QAHBABAAEEAwAAAAAAAAAAAAAAAQAQETHBIYGR/9oACAEBAAE/ISAFgeocMeKNwhnUs9E//9oADAMBAAIAAwAAABC33//EABcRAAMBAAAAAAAAAAAAAAAAAAABEXH/2gAIAQMBAT8Qaps//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERcf/aAAgBAgEBPxCVMv/EAB8QAQACAQMFAAAAAAAAAAAAAAEAESEQMUFhcYGh4f/aAAgBAQABPxAeDDv9lRDYNBNusfMeGlpZrlL4QRPUn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"my\"\n        title=\"my\"\n        src=\"/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/4b190/my.jpg\"\n        srcset=\"/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/e07e9/my.jpg 200w,\n/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/066f9/my.jpg 400w,\n/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/4b190/my.jpg 800w,\n/static/d8d2b61b6546e37bb10a4f42fa8b0dfd/4f216/my.jpg 839w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9fb6d9b599848b3662f5d010dee1665b/b4719/tekbase.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAHak0IEWChT/8QAGRAAAwEBAQAAAAAAAAAAAAAAAQISABAR/9oACAEBAAEFApxDUPeFjVNv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/Aa2P/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAES/9oACAECAQE/AYzX/8QAGRABAQADAQAAAAAAAAAAAAAAAQAQITFB/9oACAEBAAY/AiUuOHft2//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExYUFx/9oACAEBAAE/IaJYMZIAjb2W+P2GiDAwFO2f/9oADAMBAAIAAwAAABAED//EABYRAQEBAAAAAAAAAAAAAAAAAAEQMf/aAAgBAwEBPxBBsP/EABcRAQEBAQAAAAAAAAAAAAAAAAEAMWH/2gAIAQIBAT8QK5db/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBUYGRof/aAAgBAQABPxAAqtkzT5j0EQXlnioDVpNbE+aM8KA6zLt+2f/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tekbase\"\n        title=\"tekbase\"\n        src=\"/static/9fb6d9b599848b3662f5d010dee1665b/4b190/tekbase.jpg\"\n        srcset=\"/static/9fb6d9b599848b3662f5d010dee1665b/e07e9/tekbase.jpg 200w,\n/static/9fb6d9b599848b3662f5d010dee1665b/066f9/tekbase.jpg 400w,\n/static/9fb6d9b599848b3662f5d010dee1665b/4b190/tekbase.jpg 800w,\n/static/9fb6d9b599848b3662f5d010dee1665b/b4719/tekbase.jpg 1046w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Dass es funktioniert hat, liegt daran, dass das Problem relativ unbekannt ist und die Hoster entweder nicht informiert wurden, dass sie zusätzlich zu der Programmierung vom Webinterface noch weitere Schritte unternehmen müssen, oder es aus anderen Gründen unterlassen haben.<br>\nIch gehe davon aus, dass diese Methode bei vielen Hostern funktioniert. Vielleicht könnt ihr hier die Kommentarfunktion benutzen, um mitzuteilen, bei welchen Hostern dies so möglich ist.</p>\n<p>Setzt man Proftpd als Server ein, kann man dieses Vorgehen relativ einfach unterbinden.<br>\nMan verbietet den Usern per FTP den CHMOD Befehl auszuführen und stellt die Umask so streng ein, dass nur der hochladende User Zugriff auf die Dateien hat. Zusätzlich kann man auch noch den Schreibzugriff außerhalb des Serverordners verbieten</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Umask 377 277\n&lt;Directory ~/game/*>\n    &lt;Limit CHMOD RNTO RNFR STOR DELE>\n        DenyAll\n    &lt;/Limit>\n&lt;/Directory>\n\n&lt;Directory ~/game/*/orangebox/*/*>\n    &lt;Limit RNFR RNTO STOR DELE>\n        AllowAll\n    &lt;/Limit>\n&lt;/Directory></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Der Nachteil dieser Methode ist es, dass bei manchen Webinterfaces so auch keine Maps und Configs mehr hochgeladen werden können. Es muss also jeder Hoster für sich schauen, wie er das Problem für sich löst.</p>","id":"c3c8b5a8-0f19-58fe-8d15-155f216010f6","frontmatter":{"title":"Cheat Protected Server, oder doch nicht?","date":"2011-02-13","tags":["game-server","security"]},"fields":{"slug":"/cheat-protected-server-oder-doch-nicht/"},"timeToRead":3}},{"node":{"excerpt":"Im Folgenden ein paar Vorschläge, wie man seinen Apache, bzw. seinen Webspace etwas sicherer machen kann. Zum Thema Sicherheit sei noch angemerkt, dass es ein fortlaufender Prozess ist und man sein…","html":"<p>Im Folgenden ein paar Vorschläge, wie man seinen Apache, bzw. seinen Webspace etwas sicherer machen kann. Zum Thema Sicherheit sei noch angemerkt, dass es ein fortlaufender Prozess ist und man sein Konzept laufend weiter entwickeln sollte. Dieser Beitrag behandelt sicherlich nicht alles, was man machen kann und ist schon gar nicht ein komplettes Absicherungskonzept.</p>\n<p>Bei kleineren Shared Hostingumgebungen setze ich auf Apache mit suexec und fcgid, damit ich wesentlich strengere CHMODs einstellen kann und PHP mit dem jeweiligen User ausgeführt wird.<br>\nBei größeren und großen Umgebungen ist dies aber nicht sehr praktikabel, da dies zu viele Recourcen verbraucht. 500 Kunden auf einem System können so zu 500 aktiven PHP Prozessen führen. In diesem Fall muss man einen Kompromiss eingehen und leider auf suexec + fcgid verzichten.</p>\n<p>Es stellt sich dann auch die Frage, ob man nicht lieber einen Webserver nimmt, der nicht so recourcenhungrig ist. Ich denke da an Nginx und Lighttpd.</p>\n<p>Was man aber bei jeder Konfiguration und Webserverart machen sollte, ist jedem Vhost eine eigene php.ini zuweisen. Dadurch, dass jeder Vhost eine eigene php.ini hat, kann man sehr einfach individuell konfigurieren.<br>\nDer Safe Mode bringt nicht viel und wird, so weit ich weiß, wohl mit PHP6 wieder entfernt.<br>\nDie Variable open_basedir hingegen bringt echte Sicherheit und ermöglicht es einen, PHP in einem Verzeichnis und dessen Unterverzeichnissen einzusperren. Dadurch, dass jeder eine eigene php.ini hat, kann man diese Variable bequem pro Vhost einrichten.</p>\n<p>Benutzt man eine zentrale php.ini ist open_basedir entweder gar nicht gesetzt, oder sieht wie folgt aus:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">open_basedir = /var/www</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Ein Skript in /var/www/user1/http kann dabei problemlos auf Dateien aus /var/www/user2/http zugreifen. Ist die Variable gar nicht gesetzt, kann man bei nicht sehr strengen Chmods auf sehr viele Dateien im System zugreifen.<br>\nSetzt man die Variable hingegen wie folgt, hat das PHP Skript nur Zugriff auf den Webspace, auf den es hochgeladen wurde.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">open_basedir = /var/www/user1/http</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Zusätzlich dazu, sollte jeder Vhost sein eigenes Temporäres und Session Verzeichnis haben. Auch diese kann man in der php.ini definieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">upload_tmp_dir = /var/www/user1/temp\nsession.save_path = /var/www/user1/sessions</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Zu dem Einsperren sollte man noch Funktionen von PHP verbieten, die sicherheitstechnisch als kritisch anzusehen sind. Updates aus dem Webinterface heraus einspielen zu können, ist zwar bequem, erfordert aber, dass man von extern Dateien nachladen kann. Dies kann von einem Angreifer gegen einen verwendet werden. Aus diesem Grund sollte man diese Möglichkeit deaktivieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">allow_url_fopen = Off\nallow_url_include = Off</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Wenn man es nicht zwingend braucht, am besten auch den Dateiupload deaktivieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">file_uploads = Off</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Damit der Angreifer keine Shell, oder ähnliches nutzen kann, nachdem er eingebrochen ist:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">disable_functions = fopen, fclose, exec, system, ini_restore, passthru, popen, pclose, proc_nice, proc_open, shell_exec, passthru, proc_close, proc_get_status, proc_terminate, apache_note, apache_setenv, debugger_on, define_syslog_variables, openlog, syslog</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Wenn man keine Mails über den Vhost versenden will, sollte man hier auch noch die mail(); Funktion verbieten, um auszuschließen, dass der Vhost irgendwann einmal für den Spamversand genutzt wird.</p>\n<p>Um einem Angreifer gar nicht erst zu zeigen, welchen Fehler er mit welcher Attacke auslösen konnte, sollte man das Error Reporting deaktivieren:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">display_errors = Off</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nachdem PHP in seine Schranken verwiesen hat, sollte man den Zugriff auf die Dateien aus dem Browser heraus einschränken. Es gibt Angriffsarten, bei denen das Ausliefern von PHP gestört wird, so dass der Webserver beginnt, die PHP Dateien zum Download auszuliefern. Ist der Angreifer so weit gekommen, kann er sich nun eure config.php, oder wie sie auch immer genannt wird, downloaden und hat eure mysql Zugangsdaten. Ebenso kann man an andere Dateien kommen, die eigentlich niemand anderes haben sollte.</p>\n<p>Dies gilt es zu unterbinden. Beim Apache hat man die Wahl, dies über eine htaccess Datei zu machen, oder direkt im Vhost anzugeben. Ich ziehe letztere Methode vor, weil eine htaccess Datei bei jedem Seitenaufruf geparst werden muss und vor allem manipuliert, bzw. überschrieben werden kann. Zusätzlich verbiete ich den Einsatz von htacces im Vhost:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">AllowOverride None</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Beim Apache kann man nun Blacklisting, oder Whitelisting beim Dateizugriff erlauben. Das Includen von Dateien mittels PHP wird von beiden Methoden nicht beeinflusst.</p>\n<p>Viele PHP, bzw. Content Management Systeme arbeiten derart, dass immer eine bestimmte PHP, wie z.B. die index.php aufgerufen wird und diese dann nur noch unterschiedliche Dateien includiert. Hier bietet es sich an, Whitelisting zu betreiben:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;FilesMatch \"\\.php$\">\n    Order deny,allow\n    deny from all\n&lt;/FilesMatch>\n&lt;FilesMatch \"^(index|login|register|admin)\\.php$\">\n    Order allow,deny\n    allow from all\n&lt;/FilesMatch></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Bei WordPress müsste die Liste wie folgt aussehen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;FilesMatch \"^(index|wp-comments-post|xmlrpc|wp-login|post|index-extra|wp-tinymce|revision|admin|admin-ajax|load-styles|load-scripts|edit|edit-attachment-rows|edit-comments|edit-form-advanced|edit-form-comment|edit-link-categories|edit-link-category-form|edit-link-form|edit-post-rows|edit-tag-form|edit-tags)\\.php$\">\n    Order allow,deny\n    allow from all\n&lt;/FilesMatch></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>benutzt man ein andere Konzept, muss man auf Blacklisting zurück greifen. Dabei verbietet man explizit den Zugriff auf bestimmte Ordner und Dateien:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;Directory \"/var/www/user1/http/include\">\n    Order deny,allow\n    deny from all\n&lt;/Directory>\n&lt;FilesMatch \"^(config|_mysql|wp-config)\\.php$\">\n    Order deny,allow\n    deny from all\n&lt;/FilesMatch></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"688c1101-72c0-5e5c-8b72-d20bdd1c97eb","frontmatter":{"title":"Den Apache und PHP etwas sicherer machen","date":"2011-02-12","tags":["Apache2","security"]},"fields":{"slug":"/den-apachephp-etwas-sicherer-machen/"},"timeToRead":4}},{"node":{"excerpt":"Ich habe heute mal eine Spammail anderer Art bekommen. Weder die Filter meines Anbieters, noch mein Mailclient hat die Mail als Spam eingestuft. Das ganze war sogar in recht ordentlichem Deutsch, wenn…","html":"<p>Ich habe heute mal eine Spammail anderer Art bekommen. Weder die Filter meines Anbieters, noch mein Mailclient hat die Mail als Spam eingestuft. Das ganze war sogar in recht ordentlichem Deutsch, wenn auch immer noch mit Rechtschreibfehlern geschrieben.</p>\n<p>Liest sich am Anfang recht harmlos. Man stellt schon beim Lesen fest, dass der angegebene Link dazu dienen könnte, zu identifizieren, ob mein Mailaccount aktiv ist. Ruft man die Top Level Domain direkt ohne Parameter auf, erscheint eine Homepage mit ordentlichem Design. Impressum, AGB und ähnliches ist aber nicht vorhanden. Spätestens jetzt sollte wirklich jedem klar sein, dass es sich um Spam handelt.</p>\n<p>Eine Anfrage nach dem Verein beim <a href=\"https://www.handelsregister.de\" target=\"_blank\" rel=\"external noopener noreferrer\">Gemeinsamen Registerportal der Länder</a> blieb dann auch ohne Ergebnis.</p>\n<blockquote>\n<p>Sehr geehrte(r) [Hier war der richtige Vor- und Zuname],</p>\n<p>wir haben festgestellt, dass Sie zur Zeit möglicherweise in einem Krankenkassentarif versichert sind, der Ihnen kein optimales Preis/Leistungsverhältnis bietet.</p>\n<p>Daher sollten Sie noch heute prüfen, ob Sie optimal versichert sind – oder ob Ihre Krankenkasse Sie über den Tisch zieht.</p>\n<p>Krankenversicherungen wollen hohe Gewinne machen. Daher berechnen sie oft viel zu hohe Beiträge. Dagegen wehren wir uns.</p>\n<p>Prüfen Sie, ob auch Ihre Krankenkasse zu teuer ist!</p>\n<p>Unser OnlineCheck dauert nur eine Minute und verschafft Ihnen Gewissheit.<br>\nDas sollte ihnen Ihre Gesundheit wert sein!</p>\n<p>Vergleichen Sie kostenlos und unverbindlich auf:</p>\n<p><a href=\"http://februar-vergleich.com\" target=\"_blank\" rel=\"external noopener noreferrer\">http://t.februar-vergleich.com/[Zahlenfolge]</a></p>\n<p>Der vergleich ist kostenlos, es falen natürlich keine Kosten für Sie an!</p>\n<p>Vielleicht haben Sie auch den besten Tarif, viele Gesellschaften sind fair, das sollten Sie jedoch zur Sicherheit überprüfen.</p>\n<p>Ich hoffe, dass ich Ihnen helfen konnte.</p>\n<p>Mit freundlichen Grüßen aus Berlin,</p>\n<p>Corinna Schulze,</p>\n<p>Verband Sicherung der Interessen<br>\ndeutscher Privatpatienten e.V.</p>\n</blockquote>\n<hr>\n<p><strong>Nachtrag:</strong><br>\nNachdem die Kommentare darauf hindeuten, dass dem Onlineversandhaus <a href=\"http://www.mindfactory.de\" target=\"_blank\" rel=\"external noopener noreferrer\">mindfactory.de</a>, bei dem auch ich schon bestellt habe, Daten abhanden gekommen sind, habe ich den Händler um eine Stellungnahme zu dieser Vermutung gebeten.<br>\nMan darf gespannt sein, ob und was geantwortet wird.</p>\n<p>Hier ist ein Link zu selbigen Thema beim <a href=\"http://forum.mindfactory.de/meinung-uns-wichtig/53446-verkauft-mindfactory-kundendaten-2.html\" target=\"_blank\" rel=\"external noopener noreferrer\">mindfactory.de Forum</a></p>","id":"f7d45fad-82ba-5ca9-a758-29f9d4190c04","frontmatter":{"title":"Routinemäßige Überprüfung Ihres Vertrages","date":"2011-02-06","tags":["spam","Datenreichtum","security"]},"fields":{"slug":"/routinemasige-uberprufung-ihres-vertrages/"},"timeToRead":2}},{"node":{"excerpt":"Ein altes Problem bei HL2 Servern sind A2S_INFO DoS Attacken, die eine Schwachstelle im Server ausnutzen. Es gibt leider auch noch andere Schwachstellen. Diese sind nicht auf Counter-Strike Source…","html":"<p>Ein altes Problem bei HL2 Servern sind A2S_INFO DoS Attacken, die eine Schwachstelle im Server ausnutzen. Es gibt leider auch noch andere Schwachstellen. Diese sind nicht auf Counter-Strike Source beschränkt und betreffen alle Server, die die Source Technonogie benutzen. Die Folge eine solchen Attacke ist in der Regel, dass der Serverping in die Höhe schießt, und der Server massig CPU verbraucht.<br>\nDadurch, dass man nur eine geringe Bandbreite für einen erfolgreichen Angriff braucht, kann sie von jedem noch so kleinen DSL Heimanschluss erfolgreich geführt werden. Deswegen kann jeder die allermeisten HL2 basierenden Server unspielbar machen, der es schafft, eines der Programme, die sich Serverlagger, oder ähnlich nennen, zu downloaden.<br>\nKurz: Jedes rachsüchtige Kind, dass Google bedienen und eine Ip und Port in die Maske eines Programms eingeben kann, kann Server unspielbar machen.</p>\n<p>Wenn man einen Linux Server benutzt, ist das effizienteste, mittels der IPtables betreffende Pakete zu filtern. Je nach Typ des Angriffs blockiert man die Pakete vollständig, oder lässt nur eine bestimmte Anzahl pro Sekunde durch.<br>\nKleinere Skripte, die IPtable Regeln laden, mit denen man den Print Spam in den Griff kriegen kann:<br>\n<a href=\"https://github.com/Arie/tf2scripts/blob/master/rate-limit-iptables-querycache.rb\" target=\"_blank\" rel=\"external noopener noreferrer\">https://github.com/Arie/tf2scripts/</a><br>\n<a href=\"http://www.vanillatf2.org/2011/01/fighting-dos-attacks/\" target=\"_blank\" rel=\"external noopener noreferrer\">http://www.vanillatf2.org/</a></p>\n<p>Bei folgenden Beispielen ist $i der jeweilige Gameserverport und $IPTABLES ist mit \"/sbin/iptables\" definiert:<br>\nUDP Shortpackes könnte man so filtern</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token variable\">$IPTABLES</span> -A INPUT -p udp -m udp --dport <span class=\"token variable\">$i</span> -m length --length <span class=\"token number\">0</span>:28 -j DROP</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Oder</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token variable\">$IPTABLES</span> -A INPUT -p udp -m udp --dport <span class=\"token variable\">$i</span> -m length --length <span class=\"token number\">0</span>:32 -j DROP</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Bei einem RCON Bombardement kann dies hier helfen</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token variable\">$IPTABLES</span> -A INPUT -p tcp -m tcp --dport <span class=\"token variable\">$i</span> -m hashlimit --hashlimit-upto <span class=\"token number\">2</span>/sec --hashlimit-burst <span class=\"token number\">1</span> --hashlimit-mode srcip,dstip,dstport --hashlimit-name PACKET_LIMIT_<span class=\"token variable\">$i</span> -j ACCEPT</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Diese Methoden setzten natürlich voraus, dass man Rootzugang zu dem Hostystem hat.<br>\nMietet man einen Server an, muss der Hoster diese Maßnahme treffen. Leider gibt es immer wieder Hoster, die so etwas nicht machen wollen, oder wohl auch nicht können und dann Vorwände vorschieben. Es läge zwar in ihrem Interesse, diesen Typ von Angriff zu blocken, da er ja zusätzliche CPU Leistung frisst und man einen unzufriedenen Kunden hat, aber wenn man keine Ahnung von der Materie hat, dann kann man ja auch nichts unternehmen. An dieser Stelle sollte man sich dann überlegen, ob man sich den richtigen Anbieter rausgesucht hat und gegebenen Falls den Vertrag kündigen.</p>\n<p>Unternimmt der vermietende Anbieter nichts auf der IPtabel Ebene, kann man sich aber unter Umständen mit Servertools helfen:<br>\nZum einen kann hier der <a href=\"http://sourceserver.info/wiki/daf\" target=\"_blank\" rel=\"external noopener noreferrer\">DoS Attack Fixer</a> eingesetzt werden. Auf War Servern in ESL Spielen dürfen aber keine Servertools außer zBlock installiert sein. Deswegen ist dieses Servertool interessant für Puplic Server.</p>\n<p>Ich meine, dass <a href=\"http://zblock.mgamez.eu/\" target=\"_blank\" rel=\"external noopener noreferrer\">zBlock</a> ebenfalls dazu in der Lage ist, solche Attacken abzuwehren. Dieses Servertool sollte aber nur auf Warservern eingerichtet werden und kann deswegen von Puplic Server Betreibern nicht eingesetzt werden.</p>","id":"99f043db-a773-5d9e-b05b-fb2e7ae9a085","frontmatter":{"title":"Kampf den (Counter-Strike Source) Server Laggern","date":"2011-01-26","tags":["steam","Counter-Strike Source","game-server","security"]},"fields":{"slug":"/kampf-den-counter-strike-source-serverlaggern/"},"timeToRead":2}},{"node":{"excerpt":"Eins vorne weg. Ich will hier keinen davon abbringen einen Root-, oder Vserver zu mieten. ich will lediglich aufzeigen, das man sich einen solchen Schritt, vor allem aus Haftungsgründen, gründlich…","html":"<p>Eins vorne weg. Ich will hier keinen davon abbringen einen Root-, oder Vserver zu mieten. ich will lediglich aufzeigen, das man sich einen solchen Schritt, vor allem aus Haftungsgründen, gründlich überlegen sollte.</p>\n<p>Man liest immer wieder, dass XY sich einen Root-, oder Vserver angemietet hat, ohne wirklich Ahnung zu haben, was auf ihn zukommt. Die Motivation ist oft die selbe. Man will Kosten sparen. Dazu hört man von vielen Seiten, es sei doch alles so einfach und geht ganz schnell.<br>\nDie Aussage, dass es einfach geht ist vollkommen falsch. Wenn man weiß, was man tut, geht es einfach.<br>\nIn allen anderen Fällen kann man sehr viel Zeit an so einem Server verlieren und verzweifeln. Vor allem aber fordert das Betreiben von Servern viel Zeit. Man muss man ständig überwachen, kontrollieren und Sicherheitsnews verfolgen, sowie die Erkenntnisse aus diesen News umsetzen.<br>\nSomit relativiert sich der Kostenfaktor ganz schnell wieder. Rechnet man die, für den Server, aufgewendete Arbeitszeit als Kostenfaktor mit ein, wird man feststellen, dass so ein Server doch recht \"teuer\" werden kann.</p>\n<p>Verfügt man über keinerlei, oder kaum Kenntnisse über Linux, ist es sehr wahrscheinlich, dass zahlreiche Fehler gemacht werden, die andere dann nutzen werden, um in den Server einzubrechen. Der Server wird dann oft für Spam, Dos Attacken, Filesharing und Ähnliches genutzt.<br>\nFür all die Schäden, die der Einbrecher dann mit dem Server anrichtet, wirst der Mietende haftbar gemacht werden, weil er es unterlassen hast, ihn ordentlich abzusichern. Damit hat man wieder kein Geld gespart und bekommt dazu noch reichlich Ärger.</p>\n<p>Als Alternative zum selber Administrieren kann man sich zum Server jemanden suchen, der sich mit damit auskennt und dem man 100% vertrauen kann. Zum Einen kann man sich an Dienstleister wenden, zum Anderen im Bekanntenkreis nachfragen. Dabei sollte man keinen losen Internetbekanntschaften vertrauen. Vor allem nicht, wenn diese den Server kostenlos betreuen wollen. Oft selber technisch nicht versiert, wird dann munter auf fremden Server mit gefährlichem Halbwissen rumgespielt, bis es irgendwie geht und der Mietende mit dem Ergebnis, dass es funktioniert, zufrieden ist. Abgesichert ist der Server dann selten.<br>\nEs ist auch schon öfters vorgekommen, dass Personen, die damit beauftragt wurden den Server zu verwalten, selbigen für ihre Zwecke heimlich zweckentfremdet haben. Es war für sie relativ einfach, da der Mietende ohne Grundlagenwissen nicht nachvollziehen konnte, was so auf der Maschine gemacht wurde.</p>\n<p>Bevor man sich also einen Server mietet, sollte man schon wissen, wer den Server für einen administrieren wird. Wenn man es selber machen will, ist es mehr als ratsam, erst einmal zu Hause einen alten Rechner zu seinem Übungsobjekt zu machen. Ist dieser nicht vorhanden, kann auch eine Virtual Box, in die man Linux installiert, diesen Zweck erfüllen. Erst, wenn man sich in den Testumgebungen sicher fühlt, sollte man den Schritt wagen und sich an einem Server versuchen, der in einem Rechenzentrum steht.</p>","id":"9f55e673-6628-57f1-8d07-ed0e3a69d2d8","frontmatter":{"title":"Das Mieten eines Servers sollte gut überlegt sein","date":"2011-01-21","tags":["security"]},"fields":{"slug":"/warum-man-sich-das-anmieten-eines-servers-uberlegen-sollte/"},"timeToRead":2}},{"node":{"excerpt":"Man liest immer wieder, dass man Passwörter in Datenbanken am besten als md5 Hash hinterlegt und bei einem Login dann den Hash des gerade eingegebenen Passwortes mit dem hinterlegten abgleicht. Das…","html":"<p>Man liest immer wieder, dass man Passwörter in Datenbanken am besten als md5 Hash hinterlegt und bei einem Login dann den Hash des gerade eingegebenen Passwortes mit dem hinterlegten abgleicht.<br>\nDas soll sicher sein, weil man den Hash nicht wieder rekonstruieren kann.</p>\n<p>Theoretisch stimmt das ja. Aber wofür gibt es Datensammler und Datenbanken. Zu vielen Kombinationen sind die Hashes bekannt, so dass die Daten doch sehr leicht rekonstruierbar sind, hat der Angreifer erst einmal Zugriff auf die Datenbank erlangt.<br>\nWer ein wenig googelt, findet schnell einschläge Datenbanken und Suchseiten.</p>\n<p>Wer also sein eigenes Login System benutzt, sollte mal überlegen, ob er dies nicht überarbeiten will, damit die Userpasswörter im Falle eines Zugriffs auf die Datenbank nicht so einfach zurück zu übersetzen sind.</p>\n<p>Mysql bietet z.B. die Möglichkeit, die Daten mit einer 128bit AES Verschlüsselung zu versehen. Man könnte jetzt z.B. den Hashwert zusätzlich verschlüsseln und den verschlüsselten Haswert in der Datenbank hinterlgen.<br>\nHat der Angreifer den dazugehörigen Schlüssel nicht, kann er die verschlüsselten Hashwerte nicht rekonstruieren.</p>\n<hr>\n<p><strong>Nachtrag:</strong>\nIch habe nochmal rumgesucht und rumgespielt und bin dann zu folgender Lösunge mit PHP gekommen:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">passwordhash</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n <span class=\"token variable\">$passworda</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_split</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token variable\">$usernamea</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_split</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token variable\">$hash</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$usernamea</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token variable\">$passworda</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token variable\">$usernamea</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token variable\">$passworda</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">return</span> <span class=\"token variable\">$hash</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"de563c67-d22c-5a63-b188-11182d8536e9","frontmatter":{"title":"MD5 Hashes für Passwörter sind unsicherer, als man denkt.","date":"2010-11-23","tags":["security"]},"fields":{"slug":"/md5-hashes-fur-passworter-sind-unsicherer-als-man-denkt/"},"timeToRead":1}},{"node":{"excerpt":"Zugriff mit Systemusern Es treten immer wieder Probleme und dem FTP Deamon ProFTP auf. Wenn man dazu noch Tekbase einsetzt, werden sie selten weniger. Oft kommt es vor, dass die angelegten Systemuser…","html":"<h2>Zugriff mit Systemusern</h2>\n<p>Es treten immer wieder Probleme und dem FTP Deamon ProFTP auf. Wenn man dazu noch Tekbase einsetzt, werden sie selten weniger.</p>\n<p>Oft kommt es vor, dass die angelegten Systemuser sich nicht per FTP einloggen können. Tekbase legt für die User/Kunden eben diese Systemuser an.<br>\nWenn ProFTP bereits installiert ist, liegt im Regelfall eine Falschkonfiguration von selbigem vor. Dies wird sehr oft dadurch bedingt, dass der Admin auch Webspace über den Server laufen lässt und dabei ein Webinterface wie Plesk, SysCP, Froxlor, IspCP, usw. einsetzt.<br>\nSolche Panels konfigurieren den ProFTP oft wie folgt:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">AuthOrder                mod_sql.c</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Dadurch ist nur Usern aus der Datenbank, die das Panel führt, der FTP Zugriff erlaubt. Man hat nun zwei Möglichkeiten. Entweder man schreibt die Tekbase User auch in diese Datenbank, oder, was effizienter und einfacher ist, man erweitert den Eintrag in der Config wie folgt:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">AuthOrder                mod_sql.c mod_auth_unix.c</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Dies erlaubt auch Systemusern den Zugriff per FTP.<br>\nDer komplette Eintrag könnte dann so aussehen:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;ifmodule>\n LoadModule               mod_sql.c\n AuthOrder                mod_sql.c mod_auth_unix.c\n&lt;/ifmodule></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Bandbreitenlimitierung</h2>\n<p>Benutzen mehrere User mit sehr schneller Anbindung ihren FTP Account gleichzeitig und verfügt der Rootserver nur über eine 100Mbit Anbindung, kann es schnell mal passieren, dass die Anbindung überlastet ist und andere Dienste, wie z.B. Gameserver dadurch beeinträchtigt werden. Um das zu verhindern, kann man die maximal zulässige Übertragungsgeschwindigkeit einer Übertagung auf z.B. 1024kb/s einschränken:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;pre class=\"brush:shell\">TransferRate RETR 1024.0\nTransferRate STOR 1024.0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2>Den Server verschlüsseln (FTPS)</h2>\n<p>Die meisten von euch werden der Einfachheit halber einen reinen FTP Server einsetzen. Dieser arbeitet unverschlüsselt, so dass sensible Daten mitgehört werden könnten.<br>\nAus diesem Grund sollte jeder einmal überlegen, ob er nicht den ProFTP Server mit TLS verschlüsseln will. Das Stichwort hierfür ist FTPS. Im Gegensatz zu SFTP, das ein SSH-Subsystem ist, kann man weiterhin alle Einschränkungsmöglichkeiten des FTP Servers, wie z.B. Chrooting und LIMIT Anweisungen ohne zusätzliche Konfiguration weiternutzen. Bei SFTP erreicht man Chrooting nur über Umwege und Zusatzpackete.</p>\n<p>Ein weiterer Vorteil von FTPS ist, dass der User im Gegensatz zu SFTP keine Valid Shell benötigt und man ihn nicht bei AllowUsers in der sshd_config eingetragen haben muss.</p>\n<p>Wie man die verschlüsselung Platformunabhängig einrichtet, <a href=\"http://www.proftpd.de/HowTo-SFTP-TLS-verschluesse.55.0.html\" target=\"_blank\" rel=\"external noopener noreferrer\">kann man hier nachlesen</a>. Für <a href=\"http://www.howtoforge.com/setting-up-proftpd-tls-on-debian-lenny\" target=\"_blank\" rel=\"external noopener noreferrer\">Debian kann man dieses How To nutzen.</a></p>\n<h2>Nutzerrechte einschränken</h2>\n<p>Aus diversen Gründen möchte man oft den Zugriff auf bestimmte Ordner einschränken, dem User aber in den restlichen Ordnern freie Hand gewähren. Der Umständliche Weg ist per Chmod und den Eigentümerrechten der Ordner. Dieser muss Pro User eingestellt werden und ist somit nicht wirklich praktikabel.<br>\nEinfacher und für alle User auf einmal kann man das über die Directory und Limit Funktion des ProFTP Servers, die dem Aufbau einer htaccess Datei ähnlich ist.</p>\n<p>Im folgenden Beispiel ist es dem FTP User nur möglich Dateien in den Ordnern und Unterordnern zu bearbeiten, die ausdrücklich erlaubt wurden. In allen anderen Ordnern besteht lediglich das Recht zu lesen. Anhand des Beispiels sieht man gut, dass man den Ordner, ab dem der Zugriff wieder erlaubt sein soll, nicht als solchen, sondern mit /* am Ende angegeben muss:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># Schutz der Bynaries\n# Erstmal alles verbieten\n&lt;directory>&lt;limit dele=\"\" rnfr=\"\" rnto=\"\" stor=\"\">\n DenyAll\n &lt;/limit>&lt;/directory>\n\n# Die Sperre fuer das Modverzeichnis bei orangebox Spielen aufheben\n# das erste * hinter orangebox/ ist eine Wildcard, erfasst also sämtliche\n# Bezeichnungen wie tf, cstrike, dods, usw.\n&lt;directory>&lt;limit dele=\"\" rnfr=\"\" rnto=\"\" stor=\"\">\n AllowAll\n &lt;/limit>&lt;/directory>\n\n# Die Sperre fuer das Modverzeichnis bei cstrike aufheben\n&lt;directory>&lt;limit dele=\"\" rnfr=\"\" rnto=\"\" stor=\"\">\n AllowAll\n &lt;/limit>&lt;/directory>\n\n# Die Sperre fuer das Modverzeichnis bei dod aufheben\n&lt;directory>&lt;limit dele=\"\" rnfr=\"\" rnto=\"\" stor=\"\">\n AllowAll\n &lt;/limit>&lt;/directory>\n\n# Die Sperre fuer das Modverzeichnis bei czero aufheben\n&lt;directory>&lt;limit dele=\"\" rnfr=\"\" rnto=\"\" stor=\"\">\n AllowAll\n &lt;/limit>&lt;/directory></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"588b9a38-988f-5ab5-9543-6f9d7ca51328","frontmatter":{"title":"Einige Ideen für ProFTP (mit Tekbase)","date":"2010-11-16","tags":["security","ProFTP"]},"fields":{"slug":"/einige-ideen-fur-proftp-mit-tekbase/"},"timeToRead":3}},{"node":{"excerpt":"Plesk bringt Packete wie ProFTP selber mit. Das ist auch nichts schlimmes, man muss nur halt immer manuell alles updaten. Was schlimmer ist, ist dass derzeit bei allen Pleskinstallationen eine schwere…","html":"<p>Plesk bringt Packete wie ProFTP selber mit. Das ist auch nichts schlimmes, man muss nur halt immer manuell alles updaten.</p>\n<p>Was schlimmer ist, ist dass derzeit bei allen Pleskinstallationen eine schwere Sicherheitslücke im ProFTP Deamon befindet, über die sehr weitgehende Rechte erlangt werden können. Diese ist in den neueren ProFTP Versionen hinzugekommen, so dass Admins, die den Server aus den Debian Sources beziehen, nicht betroffen sind.</p>\n<p>Wer passiv ist, bekommt es gar nicht mit, wer aktiv ist kann es <a href=\"http://psa.bi-co.net/\" target=\"_blank\" rel=\"external noopener noreferrer\">hier</a> und <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3867\" target=\"_blank\" rel=\"external noopener noreferrer\">hier</a> nachlesen. Bequeme Admins sind für sowas auf deren Mailingliste, damit sie die Nachricht frei Haus bekommen.</p>\n<p>Bis man den Update bzw. Bugfix eingespielt hat, sollte man unbedingt den FTP Server zu deaktivieren.</p>\n<p>Den FTP Server bis dahin laufen zu lassen ist grob fahrlässig, da die Lücke schon auf breiter Front aktiv ausgenutzt wird.<br>\nIn einschlägigen Foren laufen mitlerweile viele Leute auf, deren Systeme über diese Lücke kompromitiert wurden.</p>\n<p>Dieser Vorfall zeigt mal wieder, dass Sicherheit ein laufender Prozess ist und die Sache nicht mit einmal einrichten getan ist.</p>","id":"86f17543-49d1-5d2e-ac58-5a8969db2c5c","frontmatter":{"title":"ProFTP Packet von Plesk verwundbar","date":"2010-11-16","tags":["security","Plesk","ProFTP"]},"fields":{"slug":"/proftp-packet-von-plesk-verwundbar/"},"timeToRead":1}},{"node":{"excerpt":"Ich hatte jemanden oft gesagt, dass die Art und Weise, wie er seinen Root Server administriert sehr unsicher ist. – Ein Passwort für alles – Für alles ein Webpanel – Administration nach dem Motto…","html":"<p>Ich hatte jemanden oft gesagt, dass die Art und Weise, wie er seinen Root Server administriert sehr unsicher ist.</p>\n<p>– Ein Passwort für alles<br>\n– Für alles ein Webpanel<br>\n– Administration nach dem Motto \"Egal wie, Hauptsache es läuft\"</p>\n<p>Diese Vorgehensweise hatte nun die absehbaren Konsequenzen.</p>\n<p>Sein Provider schickte ihm die letzten Tage Traffikwarnungen zu, so dass er einen DDOS Angriff vermutete. Ich wollte ihm dann helfen. Netstat ergab aber nichts dergleichen.</p>\n<p>Mir vielen aber ein paar Verbindungen auf, die auf einen mir unbekannten Port liefen. Der Eigentümer des Roots konnte sich auch nicht erinnern, dass er einen Dienst auf diesem Port gestartet hatte. Diese Verbindungen schienen auch recht viel outgoing Traffik zu produzieren, also die Ursache für die Traffik Warnungen zu sein.</p>\n<p>Netstat wollte auch partout nicht sagen, welches Programm zu diesem Port gehört. Alles in allem roch es sehr verdächtigt nach einer Backdoor, Rootkit und Dergleichen.</p>\n<p>Also habe ich mal lsof installiert um weiter nachzuforschen.<br>\nÜber netstat wusste ich den Port und das Protokoll:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">netstat</span> -tn <span class=\"token punctuation\">(</span>stark gekürzter output<span class=\"token punctuation\">)</span>\nActive Internet connections <span class=\"token punctuation\">(</span>w/o servers<span class=\"token punctuation\">)</span>\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp      <span class=\"token number\">112</span>  <span class=\"token number\">87504</span> hierwarneip:4936       hierwarneip:1024     ESTABLISHED\ntcp        <span class=\"token number\">0</span> <span class=\"token number\">101361</span> hierwarneip:4936       hierwarneip:54796   FIN_WAIT1\ntcp        <span class=\"token number\">0</span>  <span class=\"token number\">97152</span> hierwarneip:4936       hierwarneip:1041       ESTABLISHED\ntcp      <span class=\"token number\">112</span>  <span class=\"token number\">68392</span> hierwarneip:4936       hierwarneip:1024       ESTABLISHED</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ich wusste also, dass auf dem Port 4936 etwas lief, das so nicht laufen sollte. Der Verdacht, dass der Server gecrackt wurde erhärtete sich.<br>\nMehr Aufschluss brachte dann lsof:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">lsof</span> -i TCP:4936\nCOMMAND     PID     <span class=\"token environment constant\">USER</span>   FD   TYPE     DEVICE SIZE NODE NAME\nnanox86_6 <span class=\"token number\">32620</span> www-data    4u  IPv4 <span class=\"token number\">2740480835</span>       TCP Debian-50-lenny-64-LAMP:4936-<span class=\"token operator\">></span>hierwarneip:1041 <span class=\"token punctuation\">(</span>ESTABLISHED<span class=\"token punctuation\">)</span>\nnanox86_6 <span class=\"token number\">32620</span> www-data    6u  IPv4 <span class=\"token number\">2730374173</span>       TCP Debian-50-lenny-64-LAMP:4936-<span class=\"token operator\">></span>hierwarneip:1024 <span class=\"token punctuation\">(</span>ESTABLISHED<span class=\"token punctuation\">)</span>\nnanox86_6 <span class=\"token number\">32620</span> www-data    9u  IPv4 <span class=\"token number\">2751415190</span>       TCP Debian-50-lenny-64-LAMP:4936-<span class=\"token operator\">></span>hierwarneip:1024 <span class=\"token punctuation\">(</span>ESTABLISHED<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Das Programm sollte es so sicher nicht unter dem www-data User geben. Und siehe da eine PID, die es laut netstat gar nicht geben sollte, wurde nun auch angezeigt.<br>\nJetzt da ich eine PID hatte, war es simpel herauszufinden, welche Dateien das Programm geöffnet hatte:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">lsof</span> -p <span class=\"token number\">32620</span> <span class=\"token punctuation\">(</span>verkürzt<span class=\"token punctuation\">)</span>\nCOMMAND     PID     <span class=\"token environment constant\">USER</span>   FD   TYPE     DEVICE       SIZE     NODE NAME\nnanox86_6 <span class=\"token number\">32620</span> www-data  cwd    DIR        <span class=\"token number\">9,2</span>       <span class=\"token number\">4096</span> <span class=\"token number\">13877855</span> /root/teamspeak3/teamspeak3-server_linux-x86/files/virtualserver_1/internal/avatar_mabjihfmlikgbogieolnmdpmdgmdmpblmdikjggp\nnanox86_6 <span class=\"token number\">32620</span> www-data  txt    REG        <span class=\"token number\">9,2</span>     <span class=\"token number\">231389</span> <span class=\"token number\">13877857</span> /root/teamspeak3/teamspeak3-server_linux-x86/files/virtualserver_1/internal/avatar_mabjihfmlikgbogieolnmdpmdgmdmpblmdikjggp/nanox86_64\nnanox86_6 <span class=\"token number\">32620</span> www-data    3r   REG        <span class=\"token number\">9,2</span> <span class=\"token number\">5323653120</span> <span class=\"token number\">13877879</span> /root/teamspeak3/teamspeak3-server_linux-x86/files/virtualserver_1/internal/avatar_mabjihfmlikgbogieolnmdpmdgmdmpblmdikjggp/Blazblue.Calamity.Trigger-RELOADED.tar\nnanox86_6 <span class=\"token number\">32620</span> www-data    5r   REG        <span class=\"token number\">9,2</span> <span class=\"token number\">6017792000</span> <span class=\"token number\">13877913</span> /root/teamspeak3/teamspeak3-server_linux-x86/files/virtualserver_1/internal/avatar_mabjihfmlikgbogieolnmdpmdgmdmpblmdikjggp/F1_2010-Razor1911.tar</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Die komplette Dateiliste des teamspeak3 Ordners erspar ich euch mal. Es waren so ziemlich alle aktuellen Spiele und Filme in DVD, oder HD Format vorhanden und wurden über ein IRC Netzwerk zur Verfügung gestellt.</p>\n<p>Was war passiert? Der User, dem die ganzen Dateien gehörten und mit dem dieser Content bereit gestellt wurde war www-data. Der Einbruch ins System muss also über diesen erfolgt sein.<br>\nAuf dem Rootserver lief ein TS3 Webinterface, um selbiges zu verwalten. Diese wurde sehr wahrscheinlich auch nicht geupdatet und war Software der Kategorie, \"Hauptsache sie funktioniert\".<br>\nWie der Einbruch genau erfolgt ist, lässt sich nicht mehr nachvollziehen. Auch welche Dateien kompromitiert worden sind. Auf jeden Fall war im Webverzeichnis noch ein WI für ein Botnet versteckt und in der Datenbank Daten für dieses hinterlegt.</p>\n<p>Was man denn nun machen soll, war die Frage. Die Antwort ist kurz und schmerzlos. Kiste formatieren und neu aufsetzen. Übernehmen kann man nichts, weil man nicht weiß wie weit und wie tief das System befallen war.</p>\n<p>Hätte man von Anfang an das System abgesichert und nur vertrausnwürdige Software eingesetzt, wäre diese Extraarbeit sicherlich nicht angefallen.</p>","id":"95934ac2-a59d-5b2d-8030-56162d8a3644","frontmatter":{"title":"Rootserver sind kein Spielzeug, oder wer nicht hören kann, der muss &#8230;","date":"2010-10-02","tags":["security"]},"fields":{"slug":"/wer-nicht-horen-kann-der-muss-fuhlen/"},"timeToRead":3}},{"node":{"excerpt":"Eins vorne vor weg. Eine Softwarefirewall kann immer nur dazu genutzt werden kleineren Dreck zu filtern. Wenn euch jemand mit ausreichender Bandbreite zubombt kann nur eine vorgeschaltetet…","html":"<p>Eins vorne vor weg. Eine Softwarefirewall kann immer nur dazu genutzt werden kleineren Dreck zu filtern. Wenn euch jemand mit ausreichender Bandbreite zubombt kann nur eine vorgeschaltetet Hardwarefirewall helfen.</p>\n<p>Oft werden Angriffe von Menschen geführt, die ein Programm runtergeladen haben und sich nun als mächtiger Hacker fühlen. Eine solche Attacke, die auch gerne mal auf Gameserver mit upd Shortpackages, oder eines RCON Floods geführt wird, kann man im Regelfall mit den IPtables herausfiltern.</p>\n<p>Wenn ihr sie beim Kernelbacken nicht entfernt habt, sollten die iptables fester Bestandteil des Kernels sein. Zum verwalten der Regeln wird oft noch ein zusätzliches Programm/Packet gebraucht. Bei Debian nennt es sich \"iptables\" und kann mittels <code class=\"language-text\">apt-get install iptables</code> installiert werden.</p>\n<p>Jetzt hat man zwar eine Firewall installiert, sie filtert aber (noch) nichts. Dies liegt daran, dass man ihr erst beibringen muss, was sie durchlassen darf und was nicht. Die normale Vorgehensweise ist dabei, im ersten Schritt alles zu blocken und im zweiten dann Außnahmen zu erstellen. Wer das nicht machen will, der kann Generatoren wie diesen benutzen: <a href=\"http://harry.homelinux.org\" target=\"_blank\" rel=\"external noopener noreferrer\">http://harry.homelinux.org</a></p>\n<p>Hat man sich mittels dieses Generators eine Basis geschaffen, kann man an das Finetuning gehen und die einzelnen Gameserver zusätzlich eintragen. Ich habe mir auf der oben verlinkten Seite Regeln erstellen lassen und diese dann erweitert. Bevor ihr es in die /etc/init.d, wie im Kommentar des Skripts erklärt, eintragt, testet, ob ihr euch damit nicht selber aussperrt, indem ihr ein kleines Bashscript anlegt:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n./firewall start <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sleep</span> <span class=\"token number\">60</span> <span class=\"token operator\">&amp;&amp;</span> ./firewall stop</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Startet man dieses Script dann mit <code class=\"language-text\">screen -dmS ./teststarter</code> entfernt es die Firewallregeln nach einer Minute von selber. Im schlimmsten Fall könnt ihr dann eine Minute nicht auf den Server zugreifen. Noch besser ist es, zu Hause in einer lokalen Umgebung zu testen.</p>\n<p>Falls ihr euch doch ausgesperrt haben solltet, reicht ein Reboot aus und die Regeln sind inaktiv. Erst, wenn ihr das Skript in die init.d eintragt, werden die Regeln auch beim Reboot automatisch geladen.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token comment\"># ---------------------------------------------------------------------</span>\n<span class=\"token comment\"># Linux-iptables-Firewallskript, Copyright (c) 2010 under the GPL</span>\n<span class=\"token comment\"># Autogenerated by iptables Generator v1.22 (c) 2002-2010 by Harald Bertram</span>\n<span class=\"token comment\"># Please visit http://harry.homelinux.org for new versions of</span>\n<span class=\"token comment\"># the iptables Generator (c).</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># If you have questions about the iptables Generator or about</span>\n<span class=\"token comment\"># your Firewall-Skript feel free to take a look at out website or</span>\n<span class=\"token comment\"># send me an E-Mail to webmaster@harry.homelinux.org.</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># My special thanks are going to Lutz Heinrich (trinitywork at hotmail dot com)</span>\n<span class=\"token comment\"># who made lots of Beta-Testing and gave me lots of well qualified</span>\n<span class=\"token comment\"># Feedback that made me able to improve the iptables Generator.</span>\n<span class=\"token comment\"># --------------------------------------------------------------------</span>\n<span class=\"token comment\"># Besondere Hinweise fuer Nutzer einer Debian-Distribution oder eines Debian-Derivates (Ubuntu, Knoppix, Kanotix, ...)!</span>\n<span class=\"token comment\"># Fuehren Sie die folgenden Kommandos aus, nachdem das Skript  \"firewall\" nach /etc/init.d kopiert wurde:</span>\n<span class=\"token comment\"># chmod 755 /etc/init.d/firewall</span>\n<span class=\"token comment\"># update-rc.d firewall defaults</span>\n<span class=\"token comment\"># /etc/init.d/firewall start</span>\n<span class=\"token comment\"># --------------------------------------------------------------------</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token keyword\">in</span>\n start<span class=\"token punctuation\">)</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Starte IP-Paketfilter\"</span>\n\n <span class=\"token comment\"># iptables-Modul</span>\n modprobe ip_tables\n <span class=\"token comment\"># Connection-Tracking-Module</span>\n modprobe ip_conntrack\n <span class=\"token comment\"># Das Modul ip_conntrack_irc ist erst bei Kerneln >= 2.4.19 verfuegbar</span>\n modprobe ip_conntrack_irc\n modprobe ip_conntrack_ftp\n\n <span class=\"token comment\"># Tabelle flushen</span>\n iptables -F\n iptables -t nat -F\n iptables -t mangle -F\n iptables -X\n iptables -t nat -X\n iptables -t mangle -X\n\n <span class=\"token comment\"># Default-Policies setzen</span>\n iptables -P INPUT DROP\n iptables -P OUTPUT DROP\n iptables -P FORWARD DROP\n\n <span class=\"token comment\"># MY_REJECT-Chain</span>\n iptables -N MY_REJECT\n\n <span class=\"token comment\"># MY_REJECT fuellen</span>\n iptables -A MY_REJECT -p tcp -j REJECT --reject-with tcp-reset\n iptables -A MY_REJECT -p udp -j REJECT --reject-with icmp-port-unreachable\n iptables -A MY_REJECT -p icmp -j DROP\n iptables -A MY_REJECT -j REJECT --reject-with icmp-proto-unreachable\n\n <span class=\"token comment\"># MY_DROP-Chain</span>\n iptables -N MY_DROP\n iptables -A MY_DROP -j DROP\n\n <span class=\"token comment\"># Reject packets from RFC1918 class networks (i.e., spoofed)</span>\n iptables -A INPUT -s <span class=\"token number\">10.0</span>.0.0/8     -j DROP\n iptables -A INPUT -s <span class=\"token number\">169.254</span>.0.0/16 -j DROP\n iptables -A INPUT -s <span class=\"token number\">172.16</span>.0.0/12  -j DROP\n iptables -A INPUT -s <span class=\"token number\">127.0</span>.0.0/8    -j DROP\n iptables -A INPUT -s <span class=\"token number\">224.0</span>.0.0/4      -j DROP\n iptables -A INPUT -d <span class=\"token number\">224.0</span>.0.0/4      -j DROP\n iptables -A INPUT -s <span class=\"token number\">240.0</span>.0.0/5      -j DROP\n iptables -A INPUT -d <span class=\"token number\">240.0</span>.0.0/5      -j DROP\n iptables -A INPUT -s <span class=\"token number\">0.0</span>.0.0/8        -j DROP\n iptables -A INPUT -d <span class=\"token number\">0.0</span>.0.0/8        -j DROP\n iptables -A INPUT -d <span class=\"token number\">239.255</span>.255.0/24 -j DROP\n iptables -A INPUT -d <span class=\"token number\">255.255</span>.255.255  -j DROP\n\n <span class=\"token comment\"># Korrupte Pakete zurueckweisen</span>\n iptables -A INPUT -m state --state INVALID -j DROP\n iptables -A OUTPUT -m state --state INVALID -j DROP\n\n <span class=\"token comment\"># Stealth Scans etc. DROPpen</span>\n <span class=\"token comment\"># Keine Flags gesetzt</span>\n iptables -A INPUT -p tcp --tcp-flags ALL NONE -j MY_DROP\n\n <span class=\"token comment\"># SYN und FIN gesetzt</span>\n iptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN -j MY_DROP\n\n <span class=\"token comment\"># SYN und RST gleichzeitig gesetzt</span>\n iptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j MY_DROP\n\n <span class=\"token comment\"># FIN und RST gleichzeitig gesetzt</span>\n iptables -A INPUT -p tcp --tcp-flags FIN,RST FIN,RST -j MY_DROP\n\n <span class=\"token comment\"># FIN ohne ACK</span>\n iptables -A INPUT -p tcp --tcp-flags ACK,FIN FIN -j MY_DROP\n\n <span class=\"token comment\"># PSH ohne ACK</span>\n iptables -A INPUT -p tcp --tcp-flags ACK,PSH PSH -j MY_DROP\n\n <span class=\"token comment\"># URG ohne ACK</span>\n iptables -A INPUT -p tcp --tcp-flags ACK,URG URG -j MY_DROP\n\n <span class=\"token comment\"># Loopback-Netzwerk-Kommunikation zulassen</span>\n iptables -A INPUT -i lo -j ACCEPT\n iptables -A OUTPUT -o lo -j ACCEPT\n\n <span class=\"token comment\"># Connection-Tracking aktivieren</span>\n iptables -A OUTPUT -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT\n iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n <span class=\"token comment\"># DNS</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">53</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">53</span> -j ACCEPT\n\n <span class=\"token comment\"># FTP</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">21</span> -j ACCEPT\n\n <span class=\"token comment\"># SSH</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">22</span> -j ACCEPT\n\n<span class=\"token comment\"># HALF-LIFE</span>\n<span class=\"token comment\"># Es sind hier Beispielhaft Server auf den Ports 27115,27125,27135,27145 voreingestellt</span>\n\n<span class=\"token comment\"># HL Shortpackeges Filtern fuer Gold Source Server DDos etc</span>\n iptables -A INPUT -i eth0 -p udp -m multiport -m udp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m length --length <span class=\"token number\">0</span> -j DROP\n iptables -A INPUT -i eth0 -p udp -m multiport -m udp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m length --length <span class=\"token number\">28</span> -j DROP\n iptables -A INPUT -i eth0 -p udp -m multiport -m udp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m length --length <span class=\"token number\">39</span> -j DROP\n iptables -A INPUT -i eth0 -p udp -m multiport -m udp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m length --length <span class=\"token number\">48</span> -j DROP\n iptables -A INPUT -i eth0 -p udp -m multiport -m udp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m length --length <span class=\"token number\">105</span> -j DROP\n\n <span class=\"token comment\"># VAC Friends Autopudate etc</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">6000</span>:6003 -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">7001</span>:7002 -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">27005</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">27010</span> -j ACCEPT\n\n <span class=\"token comment\"># HALF-LIFE</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p udp -m multiport --dports <span class=\"token number\">27115,27125</span>,27135,27145 -j ACCEPT\n\n <span class=\"token comment\"># HALF-LIFE RCON</span>\n iptables -A INPUT -i eth0 -p tcp -m multiport -m tcp --dports <span class=\"token number\">27115,27125</span>,27135,27145 -m hashlimit --hashlimit-upto <span class=\"token number\">2</span>/sec --hashlimit-burst <span class=\"token number\">1</span> --hashlimit-mode srcip,dstip,dstport --hashlimit-name TF_PACKET_LIMIT -j ACCEPT \n\n <span class=\"token comment\"># Call of Duty Reihe</span>\n iptables -A INPUT -i eth0 -p udp --dport <span class=\"token number\">28960</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p udp --dport <span class=\"token number\">20800</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p udp --dport <span class=\"token number\">20810</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p udp --sport <span class=\"token number\">28960</span> -j ACCEPT\n\n <span class=\"token comment\"># Teamspeak3</span>\n iptables -A INPUT -i eth0 -p udp --dport <span class=\"token number\">9987</span> -j ACCEPT\n iptables -A INPUT -i eth0 -p tcp --dport <span class=\"token number\">30033</span> -j ACCEPT\n iptables -A INPUT -i eth0 -p tcp --dport <span class=\"token number\">10011</span> -j ACCEPT\n iptables -A INPUT -i eth0 -p tcp --dport <span class=\"token number\">2008</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p udp --dport <span class=\"token number\">9987</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p tcp --dport <span class=\"token number\">30033</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p tcp --dport <span class=\"token number\">10011</span> -j ACCEPT\n iptables -A OUTPUT -o eth0 -p tcp --dport <span class=\"token number\">2008</span> -j ACCEPT\n\n <span class=\"token comment\"># Unreal und Mods wie Killingfloor</span>\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">7707</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">7708</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">7717</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">20560</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p udp --dport <span class=\"token number\">28852</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">8075</span> -j ACCEPT\n iptables -A INPUT -i eth0 -m state --state NEW -p tcp --dport <span class=\"token number\">28852</span> -j ACCEPT\n\n <span class=\"token comment\"># Default-Policies mit REJECT</span>\n iptables -A INPUT -j MY_REJECT\n iptables -A OUTPUT -j MY_REJECT\n\n <span class=\"token comment\"># Max. 500/Sekunde (5/Jiffie) senden</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">5</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/icmp_ratelimit\n\n <span class=\"token comment\"># Speicherallozierung und -timing für IP-De/-Fragmentierung</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">262144</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/ipfrag_high_thresh\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">196608</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/ipfrag_low_thresh\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">30</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/ipfrag_time\n\n <span class=\"token comment\"># TCP-FIN-Timeout zum Schutz vor DoS-Attacken setzen</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">30</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/tcp_fin_timeout\n\n <span class=\"token comment\"># Maximal 3 Antworten auf ein TCP-SYN</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">3</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/tcp_retries1\n\n <span class=\"token comment\"># TCP-Pakete maximal 15x wiederholen</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">15</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/tcp_retries2\n\n <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n stop<span class=\"token punctuation\">)</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Stoppe IP-Paketfilter\"</span>\n <span class=\"token comment\"># Tabelle flushen</span>\n iptables -F\n iptables -t nat -F\n iptables -t mangle -F\n iptables -X\n iptables -t nat -X\n iptables -t mangle -X\n <span class=\"token comment\"># Default-Policies setzen</span>\n iptables -P INPUT ACCEPT\n iptables -P OUTPUT ACCEPT\n iptables -P FORWARD ACCEPT\n <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n status<span class=\"token punctuation\">)</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Tabelle filter\"</span>\n iptables -L -vn\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Tabelle nat\"</span>\n iptables -t nat -L -vn\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Tabelle mangle\"</span>\n iptables -t mangle -L -vn\n <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n *<span class=\"token punctuation\">)</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Fehlerhafter Aufruf\"</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Syntax: <span class=\"token variable\">$0</span> {start|stop|status}\"</span>\n <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">esac</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"1f349723-ff9c-5bb5-8875-e7b36b890e92","frontmatter":{"title":"Firewall unter Linux auch bekannt unter IPtables","date":"2010-09-25","tags":["steam","game-server","security"]},"fields":{"slug":"/firewall-unter-linux-auch-bekannt-unter-iptables/"},"timeToRead":7}},{"node":{"excerpt":"Ich habe gerade in einem Forum einen Hilfegesuch gelesen, bei dem der User einen \"nicht funktionierenden\" FTP Server hat. 220 ProFTPD 1.3.1 Server (ProFTPD) [x.x.x.x]Befehl:   USER rootAntwort:   33…","html":"<p>Ich habe gerade in einem Forum einen Hilfegesuch gelesen, bei dem der User einen \"nicht funktionierenden\" FTP Server hat.</p>\n<blockquote>\n<p>220 ProFTPD 1.3.1 Server (ProFTPD) [x.x.x.x]<br></br>Befehl:   USER root<br></br>Antwort:   331 Password required for root<br></br>Befehl:   PASS<br></br>Antwort:   530 Login incorrect.<br></br>Fehler:   Kritischer Fehler</p>\n</blockquote>\n<p>Was sagt uns das? Zum Glück scheint er an einen verantwortungsbewussten Hoster geraten zu sein, der bei seinen Vservern/Roots ProFTP so vorinstalliert, dass ein Zugriff mit dem root Account per FTP nicht möglich ist.<br>\nIch verstehe einfach nicht, wie man sich trotz vieler Warnmeldungen bei den einschlägigen Hostern selber, einen Server mietet, ohne sich auch nur ein bischen in das Thema eingearbeitet zu haben. Es sollte eigentlich zum Allgemeinwissen eines Admins gehören, dass man mit dem Adminaccount auch nur Adminaufgaben wahr nimmt.<br>\nIch sehe es leider immer wieder, das der root Account für alles genutzt wird, \"weil es ja funktioniert\".<br>\nWegen diesen verantwortungslosen Admins darf sich dann der Rest mit Angriffen und Scanns von deren Servern rumschlagen. Im Log taucht dann sowas auf:</p>\n<blockquote>\n<p>HierWarEineIP  \"GET /w00tw00t.at.ISC.SANS.DFind:) HTTP/1.1\" 400 226 \"-\" \"-\"<br></br>HierWarEineIP  \"GET /w00tw00t.at.ISC.SANS.DFind:) HTTP/1.1\" 400 226 \"-\" \"-\"<br></br>HierWarEineIP \"GET /tiny_mce/plugins/tinybrowser/tinybrowser.php HTTP/1.0\" 404 242 \"-\" \"Python-urllib/1.17\"<br></br>HierWarEineIP \"GET /joomla/plugins/editors/tinymce/jscripts/tiny_mce/plugins/tinybrowser/tinybrowser.php HTTP/1.0\" 404 282 \"-\" \"Python-urllib/1.17\"<br></br>HierWarEineIP \"GET /index.php?jumpurl=typo3conf%2Flocalconf.php&#x26;juSecure=1&#x26;type=0&#x26;locationData=1%3A HTTP/1.0\" 301 - \"-\" \"Python-urllib/1.16\"</p>\n</blockquote>","id":"419d2fb6-cbd8-5873-aac3-8b54f9b99308","frontmatter":{"title":"Verantwortungslose Admins","date":"2010-06-01","tags":["security"]},"fields":{"slug":"/verantwortungslose-admins/"},"timeToRead":1}}]}},"pageContext":{"tag":"security"}},"staticQueryHashes":["1134651766","2457448410","258428790","551055924"]}